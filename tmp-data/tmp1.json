{
  "_id": "58d4aa095e639f19bc6f8293",
  "runId": "af90570f-0e6f-4c87-8687-2184b217236f",
  "resourcesArray": [
    {
      "timestamp": "2017-03-24T05:19:12.170Z",
      "stackName": "AUDIT-AWS-RDS-QWEQWE",
      "runId": "af90570f-0e6f-4c87-8687-2184b217236f",
      "resourceType": "coreo_uni_util_notify",
      "resourceName": "advise-rds-rollup",
      "resourceId": "8171ed7dc8e95f5fc516a015ed0fb7903eb0c8a0a072360839d39ca93ee72969",
      "outputs": [],
      "namespace": "ROOT::AUDIT-AWS-RDS-QWEQWE",
      "inputs": [
        {
          "type": "choice",
          "value": "nothing",
          "name": "action"
        },
        {
          "type": "String",
          "value": "email",
          "name": "type"
        },
        {
          "type": "String",
          "value": "text",
          "name": "payload_type"
        },
        {
          "type": "String",
          "value": "\ncomposite name: audit-aws-rds\nplan name: qweqwe\nNumber of Violating Cloud Objects: 0\nRollup\n  ",
          "name": "payload"
        },
        {
          "type": "Hash",
          "value": "{:to=>\"\", :subject=>\"CloudCoreo rds rule results on audit-aws-rds :: qweqwe\"}",
          "name": "endpoint"
        },
        {
          "type": "FalseClass",
          "value": "false",
          "name": "allow_empty"
        },
        {
          "type": "String",
          "value": "change",
          "name": "send_on"
        }
      ],
      "executionTime": 4.461179016,
      "executionNumber": 12,
      "engineStatus": "OK",
      "engineState": "EXECUTING",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "58d4ac514ff94f6bf977a213"
    },
    {
      "timestamp": "2017-03-24T05:19:05.469Z",
      "stackName": "AUDIT-AWS-RDS-QWEQWE",
      "runId": "af90570f-0e6f-4c87-8687-2184b217236f",
      "resourceType": "coreo_uni_util_notify",
      "resourceName": "advise-rds-to-tag-values",
      "resourceId": "1ba2de26b48e9a7a7611e95122d1dd298633a900cde85e43d1bca04d3652c59f",
      "outputs": [],
      "namespace": "ROOT::AUDIT-AWS-RDS-QWEQWE",
      "inputs": [
        {
          "type": "choice",
          "value": "nothing",
          "name": "action"
        },
        {
          "type": "String",
          "value": {
            "truncated": {
              "object_size": 8864,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/1ba2de26b48e9a7a7611e95122d1dd298633a900cde85e43d1bca04d3652c59f/c6991088a4aa768129ddb3fd88f3aeba3d2d3167"
            }
          },
          "name": "notifiers"
        }
      ],
      "executionTime": 2.042323944,
      "executionNumber": 11,
      "engineStatus": "OK",
      "engineState": "EXECUTING",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "58d4ac4a4ff94f6bf977a212"
    },
    {
      "timestamp": "2017-03-24T05:18:59.551Z",
      "stackName": "AUDIT-AWS-RDS-QWEQWE",
      "runId": "af90570f-0e6f-4c87-8687-2184b217236f",
      "resourceType": "coreo_uni_util_jsrunner",
      "resourceName": "tags-rollup-rds",
      "resourceId": "17f8719a1cf82e0b051436bd3853911fe3242fb9a0f86e7233bcc8cb678c082e",
      "outputs": [
        {
          "value": "Number of Violating Cloud Objects: 0\nRollup",
          "name": "return"
        },
        {
          "value": {
            "truncated": {
              "object_size": 10298,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/17f8719a1cf82e0b051436bd3853911fe3242fb9a0f86e7233bcc8cb678c082e/93987a78915e0fce3a1e05ca992ae38ba0de945c"
            }
          },
          "name": "jsrunner_file"
        },
        {
          "value": "{\"name\":\"jsrunner\",\"description\":\"jsrunner\",\"engine\":\"node 6.6.0\",\"dependencies\": {\n}}\n",
          "name": "packages_file"
        },
        {
          "value": "",
          "name": "stdout"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-QWEQWE",
      "inputs": [
        {
          "type": "choice",
          "value": "run",
          "name": "action"
        },
        {
          "type": "String",
          "value": "text",
          "name": "data_type"
        },
        {
          "type": "String",
          "value": {
            "truncated": {
              "object_size": 8864,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/17f8719a1cf82e0b051436bd3853911fe3242fb9a0f86e7233bcc8cb678c082e/c6991088a4aa768129ddb3fd88f3aeba3d2d3167"
            }
          },
          "name": "json_input"
        },
        {
          "type": "String",
          "value": "const notifiers = json_input;\n\nfunction setTextRollup() {\n    let emailText = '';\n    let numberOfViolations = 0;\n    notifiers.forEach(notifier => {\n        const hasEmail = notifier['endpoint']['to'].length;\n        if(hasEmail) {\n            numberOfViolations += parseInt(notifier['num_violations']);\n            emailText += \"recipient: \" + notifier['endpoint']['to'] + \" - \" + \"Violations: \" + notifier['num_violations'] + \"\\n\";\n        }\n    });\n\n    textRollup += 'Number of Violating Cloud Objects: ' + numberOfViolations + \"\\n\";\n    textRollup += 'Rollup' + \"\\n\";\n    textRollup += emailText;\n}\n\n\nlet textRollup = '';\nsetTextRollup();\n\ncallback(textRollup);\n",
          "name": "function"
        },
        {
          "type": "FalseClass",
          "value": "false",
          "name": "provide_composite_access"
        }
      ],
      "executionTime": 6.667778867,
      "executionNumber": 10,
      "engineStatus": "OK",
      "engineState": "EXECUTING",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "58d4ac454ff94f6bf977a211"
    },
    {
      "timestamp": "2017-03-24T05:18:46.061Z",
      "stackName": "AUDIT-AWS-RDS-QWEQWE",
      "runId": "af90570f-0e6f-4c87-8687-2184b217236f",
      "resourceType": "coreo_uni_util_variables",
      "resourceName": "rds-update-planwide-3",
      "resourceId": "9a6d4078ab2f05c8a3b8160c2122826fc27192f16126d376f176721cb6610c49",
      "outputs": [
        {
          "value": "{\"us-east-1\":{\"cc-57980ce2d13-kubedev\":{\"violator_info\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-03-24T05:10:00Z\"},\"violations\":{\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"result_info\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"truncated\":{\"object_key\":\"58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/9a6d4078ab2f05c8a3b8160c2122826fc27192f16126d376f176721cb6610c49/8e4b88e19ed7a9933e3c93c652101e1040873403\",\"object_size\":1760}}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\",\"objectId\":\"cc-57980ce2d13-kubedev\",\"ruleKey\":\"rds-short-backup-retention-period\",\"suppression_until\":\"2017-01-10T00:00Z\",\"tags\":\"coreo_owner, Name\",\"email\":\"\",\"violationScheme\":{},\"suppressExpired\":true}},\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}]}}}",
          "name": "report"
        },
        {
          "value": {
            "truncated": {
              "object_size": 6995,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/9a6d4078ab2f05c8a3b8160c2122826fc27192f16126d376f176721cb6610c49/7c6dc9cb671eba457ea690bcdf2e2de5ee23d9a1"
            }
          },
          "name": "results"
        },
        {
          "value": {
            "truncated": {
              "object_size": 1461,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/9a6d4078ab2f05c8a3b8160c2122826fc27192f16126d376f176721cb6610c49/f55be0bc7ab57ab06a8492ac9df1709344787885"
            }
          },
          "name": "table"
        },
        {
          "value": {
            "truncated": {
              "object_size": 15779,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/9a6d4078ab2f05c8a3b8160c2122826fc27192f16126d376f176721cb6610c49/ffd10ab2289846b050c3a41ffee46089fdf49a35"
            }
          },
          "name": "variables"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-QWEQWE",
      "inputs": [
        {
          "type": "choice",
          "value": "set",
          "name": "action"
        },
        {
          "type": "Array",
          "value": {
            "truncated": {
              "object_size": 15779,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/9a6d4078ab2f05c8a3b8160c2122826fc27192f16126d376f176721cb6610c49/ffd10ab2289846b050c3a41ffee46089fdf49a35"
            }
          },
          "name": "variables"
        }
      ],
      "executionTime": 9.87274978,
      "executionNumber": 9,
      "engineStatus": "OK",
      "engineState": "EXECUTING",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "58d4ac374ff94f6bf977a210"
    },
    {
      "timestamp": "2017-03-24T05:18:30.988Z",
      "stackName": "AUDIT-AWS-RDS-QWEQWE",
      "runId": "af90570f-0e6f-4c87-8687-2184b217236f",
      "resourceType": "coreo_uni_util_jsrunner",
      "resourceName": "tags-to-notifiers-array-rds",
      "resourceId": "c32164e9e0619efee5e4fe2a3338181f6fcdcab377842c6fb1d32c417939da8d",
      "outputs": [
        {
          "value": {
            "truncated": {
              "object_size": 8864,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/c32164e9e0619efee5e4fe2a3338181f6fcdcab377842c6fb1d32c417939da8d/c6991088a4aa768129ddb3fd88f3aeba3d2d3167"
            }
          },
          "name": "return"
        },
        {
          "value": {
            "truncated": {
              "object_size": 7267,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/c32164e9e0619efee5e4fe2a3338181f6fcdcab377842c6fb1d32c417939da8d/70ea079ac4653154f2c9c3d9bed623d2e15b2171"
            }
          },
          "name": "jsrunner_file"
        },
        {
          "value": "{\"name\":\"jsrunner\",\"description\":\"jsrunner\",\"engine\":\"node 6.6.0\",\"dependencies\": {\n\"cloudcoreo-jsrunner-commons\": \"1.10.7-9\",\n\"js-yaml\": \"3.7.0\"}}\n",
          "name": "packages_file"
        },
        {
          "value": {
            "truncated": {
              "object_size": 13910,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/c32164e9e0619efee5e4fe2a3338181f6fcdcab377842c6fb1d32c417939da8d/28171034e3b693da31c04e50313ae95ada51af22"
            }
          },
          "name": "stdout"
        },
        {
          "value": {
            "truncated": {
              "object_size": 1461,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/c32164e9e0619efee5e4fe2a3338181f6fcdcab377842c6fb1d32c417939da8d/f55be0bc7ab57ab06a8492ac9df1709344787885"
            }
          },
          "name": "table"
        },
        {
          "value": "{\"rds-short-backup-retention-period\":[{\"cc-57980ce2d13-kubedev\":\"2017-01-10T00:00Z\"}],\"rds-no-auto-minor-version-upgrade\":[{\"put-your-object-id-here-1\":\"\"},{\"put-your-object-id-here-2\":\"\"}],\"rds-db-publicly-accessible\":[{\"put-your-object-id-here\":\"\"}],\"rds-inventory\":[{\"cc-57980ce2d13-kubedev\":\"2017-01-30T14:44Z\"}]}",
          "name": "suppression"
        },
        {
          "value": {
            "truncated": {
              "object_size": 6995,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/c32164e9e0619efee5e4fe2a3338181f6fcdcab377842c6fb1d32c417939da8d/7c6dc9cb671eba457ea690bcdf2e2de5ee23d9a1"
            }
          },
          "name": "JSONReport"
        },
        {
          "value": "{\"us-east-1\":{\"cc-57980ce2d13-kubedev\":{\"violator_info\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-03-24T05:10:00Z\"},\"violations\":{\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"result_info\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"truncated\":{\"object_key\":\"58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/c32164e9e0619efee5e4fe2a3338181f6fcdcab377842c6fb1d32c417939da8d/8e4b88e19ed7a9933e3c93c652101e1040873403\",\"object_size\":1760}}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\",\"objectId\":\"cc-57980ce2d13-kubedev\",\"ruleKey\":\"rds-short-backup-retention-period\",\"suppression_until\":\"2017-01-10T00:00Z\",\"tags\":\"coreo_owner, Name\",\"email\":\"\",\"violationScheme\":{},\"suppressExpired\":true}},\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}]}}}",
          "name": "report"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-QWEQWE",
      "inputs": [
        {
          "type": "choice",
          "value": "run",
          "name": "action"
        },
        {
          "type": "String",
          "value": "json",
          "name": "data_type"
        },
        {
          "type": "String",
          "value": {
            "truncated": {
              "object_size": 4852,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/c32164e9e0619efee5e4fe2a3338181f6fcdcab377842c6fb1d32c417939da8d/620d6ee9910c33c00397b65e7a4c529100750004"
            }
          },
          "name": "json_input"
        },
        {
          "type": "String",
          "value": {
            "truncated": {
              "object_size": 1724,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/c32164e9e0619efee5e4fe2a3338181f6fcdcab377842c6fb1d32c417939da8d/535a3e61e1c68796db3927eb8b850fc7a6ea659e"
            }
          },
          "name": "function"
        },
        {
          "type": "TrueClass",
          "value": "true",
          "name": "provide_composite_access"
        },
        {
          "type": "Array",
          "value": "[{:name=>\"cloudcoreo-jsrunner-commons\", :version=>\"1.10.7-9\"}, {:name=>\"js-yaml\", :version=>\"3.7.0\"}]",
          "name": "packages"
        }
      ],
      "executionTime": 19.322501856,
      "executionNumber": 8,
      "engineStatus": "OK",
      "engineState": "EXECUTING",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "58d4ac284ff94f6bf977a20f"
    },
    {
      "timestamp": "2017-03-24T05:18:00.968Z",
      "stackName": "AUDIT-AWS-RDS-QWEQWE",
      "runId": "af90570f-0e6f-4c87-8687-2184b217236f",
      "resourceType": "coreo_uni_util_variables",
      "resourceName": "rds-update-planwide-1",
      "resourceId": "b1e6a3544a86a432ce5066e02957baa7218f3b3fd17a4560cc5b1bd625e6fc79",
      "outputs": [
        {
          "value": {
            "truncated": {
              "object_size": 4682,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/b1e6a3544a86a432ce5066e02957baa7218f3b3fd17a4560cc5b1bd625e6fc79/932903ab6f9fb671c7cb140b567ae216d717011d"
            }
          },
          "name": "results"
        },
        {
          "value": "1",
          "name": "number_violations"
        },
        {
          "value": {
            "truncated": {
              "object_size": 5687,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/b1e6a3544a86a432ce5066e02957baa7218f3b3fd17a4560cc5b1bd625e6fc79/5f211908ce752c4673d516fdfc904f86a61d5a46"
            }
          },
          "name": "variables"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-QWEQWE",
      "inputs": [
        {
          "type": "choice",
          "value": "set",
          "name": "action"
        },
        {
          "type": "Array",
          "value": {
            "truncated": {
              "object_size": 5687,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/b1e6a3544a86a432ce5066e02957baa7218f3b3fd17a4560cc5b1bd625e6fc79/5f211908ce752c4673d516fdfc904f86a61d5a46"
            }
          },
          "name": "variables"
        }
      ],
      "executionTime": 8.208820276,
      "executionNumber": 7,
      "engineStatus": "OK",
      "engineState": "EXECUTING",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "58d4ac094ff94f6bf977a20e"
    },
    {
      "timestamp": "2017-03-24T05:17:45.373Z",
      "stackName": "AUDIT-AWS-RDS-QWEQWE",
      "runId": "af90570f-0e6f-4c87-8687-2184b217236f",
      "resourceType": "coreo_aws_rule_runner_rds",
      "resourceName": "advise-rds",
      "resourceId": "85b207d9516ccf9fef25e10abdb16935364edf4ad4355a0e73152daef35b8f14",
      "outputs": [
        {
          "value": 0,
          "name": "number_ignored_violations"
        },
        {
          "value": 1,
          "name": "number_violations"
        },
        {
          "value": 6,
          "name": "number_checks"
        },
        {
          "value": "{\"us-east-1\":{\"cc-57980ce2d13-kubedev\":{\"violator_info\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-03-24T05:10:00Z\"},\"violations\":{\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"result_info\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"truncated\":{\"object_key\":\"58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/85b207d9516ccf9fef25e10abdb16935364edf4ad4355a0e73152daef35b8f14/8e4b88e19ed7a9933e3c93c652101e1040873403\",\"object_size\":1760}}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\",\"objectId\":\"cc-57980ce2d13-kubedev\",\"ruleKey\":\"rds-short-backup-retention-period\",\"suppression_until\":\"2017-01-10T00:00Z\",\"tags\":\"coreo_owner, Name\",\"email\":\"\",\"violationScheme\":{},\"suppressExpired\":true}},\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}]}}}",
          "name": "report"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-QWEQWE",
      "inputs": [
        {
          "type": "choice",
          "value": "run",
          "name": "action"
        },
        {
          "type": "Array",
          "value": "[\"us-east-1\", \"us-east-2\", \"us-west-1\", \"us-west-2\", \"ca-central-1\", \"ap-south-1\", \"ap-northeast-2\", \"ap-southeast-1\", \"ap-southeast-2\", \"ap-northeast-1\", \"eu-central-1\", \"eu-west-1\", \"eu-west-2\", \"sa-east-1\"]",
          "name": "regions"
        },
        {
          "type": "Array",
          "value": "[\"rds-short-backup-retention-period\", \"rds-no-auto-minor-version-upgrade\", \"rds-db-publicly-accessible\"]",
          "name": "rules"
        }
      ],
      "executionTime": 41.778104688,
      "executionNumber": 6,
      "engineStatus": "OK",
      "engineState": "EXECUTING",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "58d4abfc4ff94f6bf977a20d"
    },
    {
      "timestamp": "2017-03-24T05:16:55.957Z",
      "stackName": "AUDIT-AWS-RDS-QWEQWE",
      "runId": "af90570f-0e6f-4c87-8687-2184b217236f",
      "resourceType": "coreo_uni_util_variables",
      "resourceName": "rds-planwide",
      "resourceId": "3701ab31c95a329bec7456351f5a1122e6541457ddbd76516bd8c5fa9c9651ce",
      "outputs": [
        {
          "value": "audit-aws-rds",
          "name": "composite_name"
        },
        {
          "value": "qweqwe",
          "name": "plan_name"
        },
        {
          "value": {
            "truncated": {
              "object_size": 6995,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/3701ab31c95a329bec7456351f5a1122e6541457ddbd76516bd8c5fa9c9651ce/7c6dc9cb671eba457ea690bcdf2e2de5ee23d9a1"
            }
          },
          "name": "results"
        },
        {
          "value": "1",
          "name": "number_violations"
        },
        {
          "value": "[{\"COMPOSITE::coreo_uni_util_variables.rds-rds-planwide.composite_name\"=>\"audit-aws-rds\"}, {\"COMPOSITE::coreo_uni_util_variables.rds-planwide.plan_name\"=>\"qweqwe\"}, {\"COMPOSITE::coreo_uni_util_variables.rds-planwide.results\"=>\"unset\"}, {\"COMPOSITE::coreo_uni_util_variables.rds-planwide.number_violations\"=>\"unset\"}]",
          "name": "variables"
        },
        {
          "value": {
            "truncated": {
              "object_size": 1461,
              "object_key": "58d4aa095e639f19bc6f8293/af90570f-0e6f-4c87-8687-2184b217236f/3701ab31c95a329bec7456351f5a1122e6541457ddbd76516bd8c5fa9c9651ce/f55be0bc7ab57ab06a8492ac9df1709344787885"
            }
          },
          "name": "table"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-QWEQWE",
      "inputs": [
        {
          "type": "choice",
          "value": "set",
          "name": "action"
        },
        {
          "type": "Array",
          "value": "[{\"COMPOSITE::coreo_uni_util_variables.rds-rds-planwide.composite_name\"=>\"audit-aws-rds\"}, {\"COMPOSITE::coreo_uni_util_variables.rds-planwide.plan_name\"=>\"qweqwe\"}, {\"COMPOSITE::coreo_uni_util_variables.rds-planwide.results\"=>\"unset\"}, {\"COMPOSITE::coreo_uni_util_variables.rds-planwide.number_violations\"=>\"unset\"}]",
          "name": "variables"
        }
      ],
      "executionTime": 3.927381576,
      "executionNumber": 5,
      "engineStatus": "OK",
      "engineState": "EXECUTING",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "58d4abc94ff94f6bf977a20c"
    },
    {
      "timestamp": "2017-03-24T05:16:48.601Z",
      "stackName": "AUDIT-AWS-RDS-QWEQWE",
      "runId": "af90570f-0e6f-4c87-8687-2184b217236f",
      "resourceType": "coreo_aws_rule",
      "resourceName": "rds-db-publicly-accessible",
      "resourceId": "35c0278590e197b862d595ea839a6baf3e315964f55a5e963af3ea8441ac3896",
      "outputs": [],
      "namespace": "ROOT::AUDIT-AWS-RDS-QWEQWE",
      "inputs": [
        {
          "type": "choice",
          "value": "define",
          "name": "action"
        },
        {
          "type": "String",
          "value": "RDS is publicly accessible to the world",
          "name": "display_name"
        },
        {
          "type": "String",
          "value": "object.db_instances.db_instance_identifier",
          "name": "id_map"
        },
        {
          "type": "Symbol",
          "value": "rds",
          "name": "service"
        },
        {
          "type": "Array",
          "value": "[true]",
          "name": "raise_when"
        },
        {
          "type": "Array",
          "value": "[\"db_instances\"]",
          "name": "objectives"
        },
        {
          "type": "String",
          "value": "http://kb.cloudcoreo.com/mydoc_rds-db-publicly-accessible.html",
          "name": "link"
        },
        {
          "type": "String",
          "value": "Critical",
          "name": "level"
        },
        {
          "type": "Array",
          "value": "[\"==\"]",
          "name": "operators"
        },
        {
          "type": "String",
          "value": "The affected RDS database is publicly accessible to the world.",
          "name": "description"
        },
        {
          "type": "String",
          "value": "Security",
          "name": "category"
        },
        {
          "type": "String",
          "value": "Consider whether the affected RDS database should be publicly accessible to the world. If not, modify the option which enables your RDS database to become publicly accessible.",
          "name": "suggested_action"
        },
        {
          "type": "Array",
          "value": "[]",
          "name": "call_modifiers"
        },
        {
          "type": "Array",
          "value": "[\"db_instances.publicly_accessible\"]",
          "name": "audit_objects"
        },
        {
          "type": "TrueClass",
          "value": "true",
          "name": "include_violations_in_count"
        }
      ],
      "executionTime": 1.298163107,
      "executionNumber": 4,
      "engineStatus": "OK",
      "engineState": "EXECUTING",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "58d4abc14ff94f6bf977a20b"
    },
    {
      "timestamp": "2017-03-24T05:16:44.434Z",
      "stackName": "AUDIT-AWS-RDS-QWEQWE",
      "runId": "af90570f-0e6f-4c87-8687-2184b217236f",
      "resourceType": "coreo_aws_rule",
      "resourceName": "rds-no-auto-minor-version-upgrade",
      "resourceId": "ce5ea929d17fabb4e17fad8551b44f8d776a2add64fe74837843c13e0fe6246c",
      "outputs": [],
      "namespace": "ROOT::AUDIT-AWS-RDS-QWEQWE",
      "inputs": [
        {
          "type": "meta_cis_id",
          "value": "erer",
          "name": "meta_cis_id"
        },
        {
          "type": "meta_cis_test",
          "value": "asdasdasd",
          "name": "meta_cis_tesgz"
        },
        {
          "type": "meta_always_show_card",
          "value": "true",
          "name": "meta_always_show_card"
        },
        {
          "type": "choice",
          "value": "define",
          "name": "action"
        },
        {
          "type": "String",
          "value": "RDS not set to automatically upgrade",
          "name": "display_name"
        },
        {
          "type": "String",
          "value": "object.db_instances.db_instance_identifier",
          "name": "id_map"
        },
        {
          "type": "Symbol",
          "value": "rds",
          "name": "service"
        },
        {
          "type": "Array",
          "value": "[false]",
          "name": "raise_when"
        },
        {
          "type": "Array",
          "value": "[\"db_instances\"]",
          "name": "objectives"
        },
        {
          "type": "String",
          "value": "http://kb.cloudcoreo.com/mydoc_rds-no-auto-minor-version-upgrade.html",
          "name": "link"
        },
        {
          "type": "String",
          "value": "Critical",
          "name": "level"
        },
        {
          "type": "Array",
          "value": "[\"==\"]",
          "name": "operators"
        },
        {
          "type": "String",
          "value": "RDS is not set to automatically upgrade minor versions on your database instance.",
          "name": "description"
        },
        {
          "type": "String",
          "value": "Reliability",
          "name": "category"
        },
        {
          "type": "String",
          "value": "Consider whether you would like AWS to automatically upgrade minor versions on your database instance. Modify your settings to allow minor version upgrades if possible.",
          "name": "suggested_action"
        },
        {
          "type": "Array",
          "value": "[]",
          "name": "call_modifiers"
        },
        {
          "type": "Array",
          "value": "[\"db_instances.auto_minor_version_upgrade\"]",
          "name": "audit_objects"
        },
        {
          "type": "TrueClass",
          "value": "true",
          "name": "include_violations_in_count"
        }
      ],
      "executionTime": 1.540209589,
      "executionNumber": 3,
      "engineStatus": "OK",
      "engineState": "EXECUTING",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "58d4abbd4ff94f6bf977a20a"
    },
    {
      "timestamp": "2017-03-24T05:16:39.003Z",
      "stackName": "AUDIT-AWS-RDS-QWEQWE",
      "runId": "af90570f-0e6f-4c87-8687-2184b217236f",
      "resourceType": "coreo_aws_rule",
      "resourceName": "rds-short-backup-retention-period",
      "resourceId": "9e7f004b81a84d916195336714f28427261bfb1603cf30b4509d20d1373313cf",
      "outputs": [],
      "namespace": "ROOT::AUDIT-AWS-RDS-QWEQWE",
      "inputs": [
        {
          "type": "choice",
          "value": "define",
          "name": "action"
        },
        {
          "type": "String",
          "value": "RDS short backup retention period",
          "name": "display_name"
        },
        {
          "type": "String",
          "value": "object.db_instances.db_instance_identifier",
          "name": "id_map"
        },
        {
          "type": "Symbol",
          "value": "rds",
          "name": "service"
        },
        {
          "type": "Array",
          "value": "[30]",
          "name": "raise_when"
        },
        {
          "type": "Array",
          "value": "[\"db_instances\"]",
          "name": "objectives"
        },
        {
          "type": "String",
          "value": "http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html",
          "name": "link"
        },
        {
          "type": "String",
          "value": "Warning",
          "name": "level"
        },
        {
          "type": "Array",
          "value": "[\"<\"]",
          "name": "operators"
        },
        {
          "type": "String",
          "value": "The affected RDS database has a short backup retention period (less than 30 days).",
          "name": "description"
        },
        {
          "type": "String",
          "value": "Dataloss",
          "name": "category"
        },
        {
          "type": "String",
          "value": "Modify the backup retension period to increase it to greater than 30 days.",
          "name": "suggested_action"
        },
        {
          "type": "Array",
          "value": "[]",
          "name": "call_modifiers"
        },
        {
          "type": "Array",
          "value": "[\"db_instances.backup_retention_period\"]",
          "name": "audit_objects"
        },
        {
          "type": "TrueClass",
          "value": "true",
          "name": "include_violations_in_count"
        }
      ],
      "executionTime": 1.304670228,
      "executionNumber": 2,
      "engineStatus": "OK",
      "engineState": "EXECUTING",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "58d4abb84ff94f6bf977a209"
    },
    {
      "timestamp": "2017-03-24T05:16:32.869Z",
      "stackName": "AUDIT-AWS-RDS-QWEQWE",
      "runId": "af90570f-0e6f-4c87-8687-2184b217236f",
      "resourceType": "coreo_aws_rule",
      "resourceName": "rds-inventory",
      "resourceId": "7ce0fbe78e8d61cca2eb382a111e58131a1b4f1a77a1b7fd2928e7b088f33a7e",
      "outputs": [],
      "namespace": "ROOT::AUDIT-AWS-RDS-QWEQWE",
      "inputs": [
        {
          "type": "choice",
          "value": "define",
          "name": "action"
        },
        {
          "type": "String",
          "value": "RDS Instance Inventory",
          "name": "display_name"
        },
        {
          "type": "String",
          "value": "object.db_instances.db_instance_identifier",
          "name": "id_map"
        },
        {
          "type": "Symbol",
          "value": "rds",
          "name": "service"
        },
        {
          "type": "Array",
          "value": "[//]",
          "name": "raise_when"
        },
        {
          "type": "Array",
          "value": "[\"db_instances\"]",
          "name": "objectives"
        },
        {
          "type": "String",
          "value": "Informational",
          "name": "level"
        },
        {
          "type": "Array",
          "value": "[\"=~\"]",
          "name": "operators"
        },
        {
          "type": "String",
          "value": "This rule performs an inventory on all RDS DB instances in the target AWS account.",
          "name": "description"
        },
        {
          "type": "String",
          "value": "Inventory",
          "name": "category"
        },
        {
          "type": "String",
          "value": "None.",
          "name": "suggested_action"
        },
        {
          "type": "Array",
          "value": "[]",
          "name": "call_modifiers"
        },
        {
          "type": "Array",
          "value": "[\"object.db_instances.db_instance_identifier\"]",
          "name": "audit_objects"
        },
        {
          "type": "FalseClass",
          "value": "false",
          "name": "include_violations_in_count"
        }
      ],
      "executionTime": 21.607371284,
      "executionNumber": 1,
      "engineStatus": "OK",
      "engineState": "EXECUTING",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "58d4abb24ff94f6bf977a208"
    }
  ],
  "numberOfResources": 12,
  "planRefreshIntervalInHours": 24,
  "lastExecutionTime": "2017-03-24T05:15:50.930Z",
  "engineState": "COMPLETED",
  "engineStatus": "OK",
  "isEnabled": false
}