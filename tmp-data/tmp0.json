{
  "resourcesArray": [
    {
      "timestamp": "2017-01-17T09:20:17.000Z",
      "stackName": "AUDIT-AWS-RDS-TRETRTRE",
      "runId": "8c8ca9d3-73c3-4015-bb37-b68f977ca52d",
      "resourceType": "coreo_aws_advisor_alert",
      "resourceName": "rds-inventory",
      "resourceId": "e66f0c5107a2406624265f8aa2c235ed04b9c4b049cc56be1175ee26d8c7e664",
      "outputs": [
        {
          "value": "cc_587c847c7d2_rds-inventory",
          "name": "ec2_name"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-TRETRTRE",
      "inputs": [
        {
          "type": "choice",
          "value": "define",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "RDS Instance Inventory",
          "name": "display_name"
        },
        {
          "type": "PLA-1366",
          "value": "object.db_instances.db_instance_identifier",
          "name": "id_map"
        },
        {
          "type": "PLA-1366",
          "value": "rds",
          "name": "service"
        },
        {
          "type": "PLA-1366",
          "value": [
            "(?-mix:)"
          ],
          "name": "alert_when"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances"
          ],
          "name": "objectives"
        },
        {
          "type": "PLA-1366",
          "value": "Informational",
          "name": "level"
        },
        {
          "type": "PLA-1366",
          "value": [
            "=~"
          ],
          "name": "operators"
        },
        {
          "type": "PLA-1366",
          "value": "This rule performs an inventory on all RDS DB instances in the target AWS account.",
          "name": "description"
        },
        {
          "type": "PLA-1366",
          "value": "Inventory",
          "name": "category"
        },
        {
          "type": "PLA-1366",
          "value": "None.",
          "name": "suggested_action"
        },
        {
          "type": "PLA-1366",
          "value": [],
          "name": "call_modifiers"
        },
        {
          "type": "PLA-1366",
          "value": [
            "object.db_instances.db_instance_identifier"
          ],
          "name": "audit_objects"
        },
        {
          "type": "PLA-1366",
          "value": false,
          "name": "include_violations_in_count"
        }
      ],
      "executionTime": 9.117212146,
      "executionNumber": 1,
      "engineStatus": "OK",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "587c8509a344b45595c9a1a7"
    },
    {
      "timestamp": "2017-01-17T09:20:21.000Z",
      "stackName": "AUDIT-AWS-RDS-TRETRTRE",
      "runId": "8c8ca9d3-73c3-4015-bb37-b68f977ca52d",
      "resourceType": "coreo_aws_advisor_alert",
      "resourceName": "rds-short-backup-retention-period",
      "resourceId": "18e1e2ef6901b02aca4e8e019c4f23c8d6cc1cd5d32f63190dc40771910a379d",
      "outputs": [
        {
          "value": "cc_587c847c7d2_rds-short-backup-retention-period",
          "name": "ec2_name"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-TRETRTRE",
      "inputs": [
        {
          "type": "choice",
          "value": "define",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "RDS short backup retention period",
          "name": "display_name"
        },
        {
          "type": "PLA-1366",
          "value": "object.db_instances.db_instance_identifier",
          "name": "id_map"
        },
        {
          "type": "PLA-1366",
          "value": "rds",
          "name": "service"
        },
        {
          "type": "PLA-1366",
          "value": [
            30
          ],
          "name": "alert_when"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances"
          ],
          "name": "objectives"
        },
        {
          "type": "PLA-1366",
          "value": "http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html",
          "name": "link"
        },
        {
          "type": "PLA-1366",
          "value": "Warning",
          "name": "level"
        },
        {
          "type": "PLA-1366",
          "value": [
            "<"
          ],
          "name": "operators"
        },
        {
          "type": "PLA-1366",
          "value": "The affected RDS database has a short backup retention period (less than 30 days).",
          "name": "description"
        },
        {
          "type": "PLA-1366",
          "value": "Dataloss",
          "name": "category"
        },
        {
          "type": "PLA-1366",
          "value": "Modify the backup retension period to increase it to greater than 30 days.",
          "name": "suggested_action"
        },
        {
          "type": "PLA-1366",
          "value": [],
          "name": "call_modifiers"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances.backup_retention_period"
          ],
          "name": "audit_objects"
        },
        {
          "type": "PLA-1366",
          "value": true,
          "name": "include_violations_in_count"
        }
      ],
      "executionTime": 1.383612427,
      "executionNumber": 2,
      "engineStatus": "OK",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "587c850da344b45595c9a1a8"
    },
    {
      "timestamp": "2017-01-17T09:20:23.000Z",
      "stackName": "AUDIT-AWS-RDS-TRETRTRE",
      "runId": "8c8ca9d3-73c3-4015-bb37-b68f977ca52d",
      "resourceType": "coreo_aws_advisor_alert",
      "resourceName": "rds-no-auto-minor-version-upgrade",
      "resourceId": "dc9df1e373ca6b6383701d6a348958ff71846ef28c12c59aa6dc0cecac4b0f4a",
      "outputs": [
        {
          "value": "cc_587c847c7d2_rds-no-auto-minor-version-upgrade",
          "name": "ec2_name"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-TRETRTRE",
      "inputs": [
        {
          "type": "choice",
          "value": "define",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "RDS not set to automatically upgrade",
          "name": "display_name"
        },
        {
          "type": "PLA-1366",
          "value": "object.db_instances.db_instance_identifier",
          "name": "id_map"
        },
        {
          "type": "PLA-1366",
          "value": "rds",
          "name": "service"
        },
        {
          "type": "PLA-1366",
          "value": [
            false
          ],
          "name": "alert_when"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances"
          ],
          "name": "objectives"
        },
        {
          "type": "PLA-1366",
          "value": "http://kb.cloudcoreo.com/mydoc_rds-no-auto-minor-version-upgrade.html",
          "name": "link"
        },
        {
          "type": "PLA-1366",
          "value": "Error",
          "name": "level"
        },
        {
          "type": "PLA-1366",
          "value": [
            "=="
          ],
          "name": "operators"
        },
        {
          "type": "PLA-1366",
          "value": "RDS is not set to automatically upgrade minor versions on your database instance.",
          "name": "description"
        },
        {
          "type": "PLA-1366",
          "value": "Reliability",
          "name": "category"
        },
        {
          "type": "PLA-1366",
          "value": "Consider whether you would like AWS to automatically upgrade minor versions on your database instance. Modify your settings to allow minor version upgrades if possible.",
          "name": "suggested_action"
        },
        {
          "type": "PLA-1366",
          "value": [],
          "name": "call_modifiers"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances.auto_minor_version_upgrade"
          ],
          "name": "audit_objects"
        },
        {
          "type": "PLA-1366",
          "value": true,
          "name": "include_violations_in_count"
        }
      ],
      "executionTime": 1.282271136,
      "executionNumber": 3,
      "engineStatus": "OK",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "587c850fa344b45595c9a1a9"
    },
    {
      "timestamp": "2017-01-17T09:20:25.000Z",
      "stackName": "AUDIT-AWS-RDS-TRETRTRE",
      "runId": "8c8ca9d3-73c3-4015-bb37-b68f977ca52d",
      "resourceType": "coreo_aws_advisor_alert",
      "resourceName": "rds-db-publicly-accessible",
      "resourceId": "e31a449d1c66893fc2efaaf6cb3f579a8d9498b2b59ca40e917670f1d0de06e9",
      "outputs": [
        {
          "value": "cc_587c847c7d2_rds-db-publicly-accessible",
          "name": "ec2_name"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-TRETRTRE",
      "inputs": [
        {
          "type": "choice",
          "value": "define",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "RDS is publicly accessible to the world",
          "name": "display_name"
        },
        {
          "type": "PLA-1366",
          "value": "object.db_instances.db_instance_identifier",
          "name": "id_map"
        },
        {
          "type": "PLA-1366",
          "value": "rds",
          "name": "service"
        },
        {
          "type": "PLA-1366",
          "value": [
            true
          ],
          "name": "alert_when"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances"
          ],
          "name": "objectives"
        },
        {
          "type": "PLA-1366",
          "value": "http://kb.cloudcoreo.com/mydoc_rds-db-publicly-accessible.html",
          "name": "link"
        },
        {
          "type": "PLA-1366",
          "value": "Critical",
          "name": "level"
        },
        {
          "type": "PLA-1366",
          "value": [
            "=="
          ],
          "name": "operators"
        },
        {
          "type": "PLA-1366",
          "value": "The affected RDS database is publicly accessible to the world.",
          "name": "description"
        },
        {
          "type": "PLA-1366",
          "value": "Security",
          "name": "category"
        },
        {
          "type": "PLA-1366",
          "value": "Consider whether the affected RDS database should be publicly accessible to the world. If not, modify the option which enables your RDS database to become publicly accessible.",
          "name": "suggested_action"
        },
        {
          "type": "PLA-1366",
          "value": [],
          "name": "call_modifiers"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances.publicly_accessible"
          ],
          "name": "audit_objects"
        },
        {
          "type": "PLA-1366",
          "value": true,
          "name": "include_violations_in_count"
        }
      ],
      "executionTime": 1.379579873,
      "executionNumber": 4,
      "engineStatus": "OK",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "587c8512a344b45595c9a1aa"
    },
    {
      "timestamp": "2017-01-17T09:20:38.000Z",
      "stackName": "AUDIT-AWS-RDS-TRETRTRE",
      "runId": "8c8ca9d3-73c3-4015-bb37-b68f977ca52d",
      "resourceType": "coreo_aws_advisor_rds",
      "resourceName": "advise-rds",
      "resourceId": "87a783e2abb0ca8fc034f863d3e4cfd6c069e7a9fb7be0c199405c06d93fcda3",
      "outputs": [
        {
          "value": "cc_587c847c7d2_advise-rds",
          "name": "ec2_name"
        },
        {
          "value": 0,
          "name": "number_ignored_violations"
        },
        {
          "value": 2,
          "name": "number_violations"
        },
        {
          "value": 8,
          "name": "number_checks"
        },
        {
          "value": "{\"cc-57980ce2d13-kubedev\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}]},\"cc-581e59ffbd6-kubestg\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+2@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubestg\",\"key\":\"Name\"}]}}",
          "name": "report"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-TRETRTRE",
      "inputs": [
        {
          "type": "choice",
          "value": "advise",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": [
            "us-east-1",
            "us-east-2",
            "us-west-1",
            "us-west-2",
            "eu-west-1"
          ],
          "name": "regions"
        },
        {
          "type": "PLA-1366",
          "value": [
            "rds-short-backup-retention-period",
            "rds-inventory"
          ],
          "name": "alerts"
        }
      ],
      "executionTime": 9.597146722,
      "executionNumber": 5,
      "engineStatus": "OK",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "587c8520a344b45595c9a1ab"
    },
    {
      "timestamp": "2017-01-17T09:20:46.000Z",
      "stackName": "AUDIT-AWS-RDS-TRETRTRE",
      "runId": "8c8ca9d3-73c3-4015-bb37-b68f977ca52d",
      "resourceType": "coreo_uni_util_jsrunner",
      "resourceName": "rds-aggregate",
      "resourceId": "215d8d52bf7dd6a678bcef4fa38b0740db7542fe3b9804a231595f8eb08e8907",
      "outputs": [
        {
          "value": "cc_587c847c7d2_rds-aggregate",
          "name": "ec2_name"
        },
        {
          "value": "{\"composite name\":\"audit-aws-rds\",\"plan name\":\"tretrtre\",\"number_of_checks\":\"8\",\"number_of_violations\":\"2\",\"number_violations_ignored\":\"0\",\"regions\":\"['us-east-1','us-east-2','us-west-1','us-west-2','eu-west-1']\",\"violations\":{\"cc-57980ce2d13-kubedev\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}]},\"cc-581e59ffbd6-kubestg\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+2@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubestg\",\"key\":\"Name\"}]}}}",
          "name": "return"
        },
        {
          "value": "#!/usr/bin/env node\nconst util = require('util')\n\nvar input = {\"composite name\":\"audit-aws-rds\",\n  \"plan name\":\"tretrtre\",\n  \"number_of_checks\":\"8\",\n  \"number_of_violations\":\"2\",\n  \"number_violations_ignored\":\"0\",\n  \"violations\":{\"cc-57980ce2d13-kubedev\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}]},\"cc-581e59ffbd6-kubestg\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+2@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubestg\",\"key\":\"Name\"}]}}};\n\nfunction coreoExport(variable, value) {\n    if (! /^[A-Za-z]+[A-Za-z0-9_-]*/.test(variable)) {\n        throw(`${variable} is not a valid variable name`);\n    }\n\n    console.log(`CC_EXPORT_OUTPUT_STARTS_HERE`);\n    console.log(`${variable}=${value}`);\n    console.log(`CC_EXPORT_OUTPUT_ENDS_HERE`);\n}\n\nfunction myfunc(json_input, callback) {\n\nvar_regions = \"['us-east-1','us-east-2','us-west-1','us-west-2','eu-west-1']\";\n\nvar result = {};\nresult['composite name'] = json_input['composite name'];\nresult['plan name'] = json_input['plan name'];\nresult['number_of_checks'] = json_input['number_of_checks'];\nresult['number_of_violations'] = json_input['number_of_violations'];\nresult['number_violations_ignored'] = json_input['number_violations_ignored'];\nresult['regions'] = var_regions;\nresult['violations'] = json_input['violations'];\n\ncallback(result);\n\n}\n\nvar ret = myfunc(input, function (data) {\n    console.log('CC_USER_OUTPUT_STARTS_HERE');\n    if (\"json\" == \"json\") {\n      console.log(JSON.stringify(data));\n    } else {\n      console.log(data);\n    }\n    console.log('CC_USER_OUTPUT_ENDS_HERE');\n});\n",
          "name": "jsrunner_file"
        },
        {
          "value": "{\"name\":\"jsrunner\",\"description\":\"jsrunner\",\"engine\":\"node 6.6.0\",\"dependencies\": {\n}}\n",
          "name": "packages_file"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-TRETRTRE",
      "inputs": [
        {
          "type": "choice",
          "value": "run",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "json",
          "name": "data_type"
        },
        {
          "type": "PLA-1366",
          "value": "{\"composite name\":\"audit-aws-rds\",\n  \"plan name\":\"tretrtre\",\n  \"number_of_checks\":\"8\",\n  \"number_of_violations\":\"2\",\n  \"number_violations_ignored\":\"0\",\n  \"violations\":{\"cc-57980ce2d13-kubedev\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}]},\"cc-581e59ffbd6-kubestg\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+2@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubestg\",\"key\":\"Name\"}]}}}",
          "name": "json_input"
        },
        {
          "type": "PLA-1366",
          "value": "\nvar_regions = \"['us-east-1','us-east-2','us-west-1','us-west-2','eu-west-1']\";\n\nvar result = {};\nresult['composite name'] = json_input['composite name'];\nresult['plan name'] = json_input['plan name'];\nresult['number_of_checks'] = json_input['number_of_checks'];\nresult['number_of_violations'] = json_input['number_of_violations'];\nresult['number_violations_ignored'] = json_input['number_violations_ignored'];\nresult['regions'] = var_regions;\nresult['violations'] = json_input['violations'];\n\ncallback(result);\n",
          "name": "function"
        },
        {
          "type": "PLA-1366",
          "value": false,
          "name": "provide_composite_access"
        }
      ],
      "executionTime": 4.816839351,
      "executionNumber": 6,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "587c8528a344b45595c9a1ac"
    },
    {
      "timestamp": "2017-01-17T09:21:29.000Z",
      "stackName": "AUDIT-AWS-RDS-TRETRTRE",
      "runId": "8c8ca9d3-73c3-4015-bb37-b68f977ca52d",
      "resourceType": "coreo_uni_util_jsrunner",
      "resourceName": "tags-rollup-rds",
      "resourceId": "e9199b26b3b2262924af34609f5f43592106f27a88166e91964877de90a11de9",
      "outputs": [
        {
          "value": "cc_587c847c7d2_tags-rollup-rds",
          "name": "ec2_name"
        },
        {
          "value": "number of Violations: 2\nRollup\nrecipient: natalia@cloudcoreo.com - nViolations: 2",
          "name": "return"
        },
        {
          "value": "#!/usr/bin/env node\nconst util = require('util')\n\nvar input = [{\"type\":\"email\",\"send_on\":\"change\",\"allow_empty\":\"false\",\"payload_type\":\"html\",\"endpoint\":{\"to\":\"natalia@cloudcoreo.com\"},\"payload\":\"<h2>Composite name: audit-aws-rds</h2><h3>Plan name: tretrtre</h3><p>Number of violations: 2</p><div style=\\\"border:1px solid #6b6b6b;border-left-width:10px;font-family:sans-serif;color:#333333;max-width:700px;font-size: 14px;margin:20px 0;\\\">\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 15px;overflow: hidden;border-bottom:1px solid #d4d4d4;margin-bottom: 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<span style=\\\"font-size: 18px;font-weight: bold;line-height: 20px;float: left;\\\">\\n\\t\\t\\t\\t\\t\\t\\tRDS Instance Inventory\\n\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-left:20px;\\\">1 Resources</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px; \\\">Informational</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-right:20px;\\\">rds</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"width: 100%;float: left;line-height: 16px;\\\">Alert ID: rds-inventory</span>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 0 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Category</i>\\n\\t\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">Inventory</p>\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Description</i>\\n\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\t\\tThis rule performs an inventory on all RDS DB instances in the target AWS account.\\n\\t\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t<div style=\\\"background: #e2e2e2; padding: 15px 15px 2px;\\\">\\n\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Suggested Fix</i>\\n\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\tNone.\\n\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t<p></p>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: bold; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(16.666666666666668% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\">RDS Instance</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Region</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Engine Type</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Engine Version</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Instance Type</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Tags</div></div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: normal; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(16.666666666666668% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\"><a href=\\'https://console.aws.amazon.com/rds/home?region=us-east-1#dbinstances:id=cc-581e59ffbd6-kubestg;sf=all\\'>cc-581e59ffbd6-kubestg</a></div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">us-east-1</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">mysql</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">5.6.29</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">db.t2.micro</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">coreo_owner, Name</div></div><div style=\\\"border:1px solid #e49530;border-left-width:10px;font-family:sans-serif;color:#333333;max-width:700px;font-size: 14px;margin:20px 0;\\\">\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 15px;overflow: hidden;border-bottom:1px solid #d4d4d4;margin-bottom: 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<span style=\\\"font-size: 18px;font-weight: bold;line-height: 20px;float: left;\\\">\\n\\t\\t\\t\\t\\t\\t\\tRDS short backup retention period\\n\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-left:20px;\\\">2 Resources</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px; \\\">Warning</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-right:20px;\\\">rds</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"width: 100%;float: left;line-height: 16px;\\\">Alert ID: rds-short-backup-retention-period</span>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 0 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Category</i>\\n\\t\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">Dataloss</p>\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Description</i>\\n\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\t\\tThe affected RDS database has a short backup retention period (less than 30 days).\\n\\t\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t<div style=\\\"background: #e2e2e2; padding: 15px 15px 2px;\\\">\\n\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Suggested Fix</i>\\n\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\tModify the backup retension period to increase it to greater than 30 days.\\n\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t<p><a href=http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html>CloudCoreo Knowledge Base</a></p>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: bold; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(25% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\">RDS Instance</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Backup Retention Period</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Region</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Tags</div></div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: normal; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(25% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\"><a href=\\'https://console.aws.amazon.com/rds/home?region=us-east-1#dbinstances:id=cc-57980ce2d13-kubedev;sf=all\\'>cc-57980ce2d13-kubedev</a></div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">2</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">us-east-1</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">coreo_owner, Name</div></div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: normal; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(25% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\"><a href=\\'https://console.aws.amazon.com/rds/home?region=us-east-1#dbinstances:id=cc-581e59ffbd6-kubestg;sf=all\\'>cc-581e59ffbd6-kubestg</a></div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">2</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">us-east-1</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">coreo_owner, Name</div></div>\",\"num_violations\":\"2\",\"num_instances\":\"0\"}];\n\nfunction coreoExport(variable, value) {\n    if (! /^[A-Za-z]+[A-Za-z0-9_-]*/.test(variable)) {\n        throw(`${variable} is not a valid variable name`);\n    }\n\n    console.log(`CC_EXPORT_OUTPUT_STARTS_HERE`);\n    console.log(`${variable}=${value}`);\n    console.log(`CC_EXPORT_OUTPUT_ENDS_HERE`);\n}\n\nfunction myfunc(json_input, callback) {\nvar rollup_string = \"\";\nlet rollup = '';\nlet emailText = '';\nlet numberOfViolations = 0;\nfor (var entry=0; entry < json_input.length; entry++) {\n    if (json_input[entry]['endpoint']['to'].length) {\n        numberOfViolations += parseInt(json_input[entry]['num_violations']);\n        emailText += \"recipient: \" + json_input[entry]['endpoint']['to'] + \" - \" + \"nViolations: \" + json_input[entry]['num_violations'] + \"\\n\";\n    }\n}\n\nrollup += 'number of Violations: ' + numberOfViolations + \"\\n\";\nrollup += 'Rollup' + \"\\n\";\nrollup += emailText;\n\nrollup_string = rollup;\ncallback(rollup_string);\n\n}\n\nvar ret = myfunc(input, function (data) {\n    console.log('CC_USER_OUTPUT_STARTS_HERE');\n    if (\"text\" == \"json\") {\n      console.log(JSON.stringify(data));\n    } else {\n      console.log(data);\n    }\n    console.log('CC_USER_OUTPUT_ENDS_HERE');\n});\n",
          "name": "jsrunner_file"
        },
        {
          "value": "{\"name\":\"jsrunner\",\"description\":\"jsrunner\",\"engine\":\"node 6.6.0\",\"dependencies\": {\n}}\n",
          "name": "packages_file"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-TRETRTRE",
      "inputs": [
        {
          "type": "choice",
          "value": "run",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "text",
          "name": "data_type"
        },
        {
          "type": "PLA-1366",
          "value": "[{\"type\":\"email\",\"send_on\":\"change\",\"allow_empty\":\"false\",\"payload_type\":\"html\",\"endpoint\":{\"to\":\"natalia@cloudcoreo.com\"},\"payload\":\"<h2>Composite name: audit-aws-rds</h2><h3>Plan name: tretrtre</h3><p>Number of violations: 2</p><div style=\\\"border:1px solid #6b6b6b;border-left-width:10px;font-family:sans-serif;color:#333333;max-width:700px;font-size: 14px;margin:20px 0;\\\">\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 15px;overflow: hidden;border-bottom:1px solid #d4d4d4;margin-bottom: 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<span style=\\\"font-size: 18px;font-weight: bold;line-height: 20px;float: left;\\\">\\n\\t\\t\\t\\t\\t\\t\\tRDS Instance Inventory\\n\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-left:20px;\\\">1 Resources</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px; \\\">Informational</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-right:20px;\\\">rds</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"width: 100%;float: left;line-height: 16px;\\\">Alert ID: rds-inventory</span>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 0 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Category</i>\\n\\t\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">Inventory</p>\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Description</i>\\n\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\t\\tThis rule performs an inventory on all RDS DB instances in the target AWS account.\\n\\t\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t<div style=\\\"background: #e2e2e2; padding: 15px 15px 2px;\\\">\\n\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Suggested Fix</i>\\n\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\tNone.\\n\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t<p></p>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: bold; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(16.666666666666668% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\">RDS Instance</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Region</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Engine Type</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Engine Version</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Instance Type</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Tags</div></div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: normal; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(16.666666666666668% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\"><a href='https://console.aws.amazon.com/rds/home?region=us-east-1#dbinstances:id=cc-581e59ffbd6-kubestg;sf=all'>cc-581e59ffbd6-kubestg</a></div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">us-east-1</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">mysql</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">5.6.29</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">db.t2.micro</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">coreo_owner, Name</div></div><div style=\\\"border:1px solid #e49530;border-left-width:10px;font-family:sans-serif;color:#333333;max-width:700px;font-size: 14px;margin:20px 0;\\\">\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 15px;overflow: hidden;border-bottom:1px solid #d4d4d4;margin-bottom: 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<span style=\\\"font-size: 18px;font-weight: bold;line-height: 20px;float: left;\\\">\\n\\t\\t\\t\\t\\t\\t\\tRDS short backup retention period\\n\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-left:20px;\\\">2 Resources</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px; \\\">Warning</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-right:20px;\\\">rds</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"width: 100%;float: left;line-height: 16px;\\\">Alert ID: rds-short-backup-retention-period</span>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 0 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Category</i>\\n\\t\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">Dataloss</p>\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Description</i>\\n\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\t\\tThe affected RDS database has a short backup retention period (less than 30 days).\\n\\t\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t<div style=\\\"background: #e2e2e2; padding: 15px 15px 2px;\\\">\\n\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Suggested Fix</i>\\n\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\tModify the backup retension period to increase it to greater than 30 days.\\n\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t<p><a href=http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html>CloudCoreo Knowledge Base</a></p>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: bold; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(25% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\">RDS Instance</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Backup Retention Period</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Region</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Tags</div></div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: normal; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(25% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\"><a href='https://console.aws.amazon.com/rds/home?region=us-east-1#dbinstances:id=cc-57980ce2d13-kubedev;sf=all'>cc-57980ce2d13-kubedev</a></div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">2</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">us-east-1</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">coreo_owner, Name</div></div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: normal; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(25% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\"><a href='https://console.aws.amazon.com/rds/home?region=us-east-1#dbinstances:id=cc-581e59ffbd6-kubestg;sf=all'>cc-581e59ffbd6-kubestg</a></div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">2</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">us-east-1</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">coreo_owner, Name</div></div>\",\"num_violations\":\"2\",\"num_instances\":\"0\"}]",
          "name": "json_input"
        },
        {
          "type": "PLA-1366",
          "value": "var rollup_string = \"\";\nlet rollup = '';\nlet emailText = '';\nlet numberOfViolations = 0;\nfor (var entry=0; entry < json_input.length; entry++) {\n    if (json_input[entry]['endpoint']['to'].length) {\n        numberOfViolations += parseInt(json_input[entry]['num_violations']);\n        emailText += \"recipient: \" + json_input[entry]['endpoint']['to'] + \" - \" + \"nViolations: \" + json_input[entry]['num_violations'] + \"\\n\";\n    }\n}\n\nrollup += 'number of Violations: ' + numberOfViolations + \"\\n\";\nrollup += 'Rollup' + \"\\n\";\nrollup += emailText;\n\nrollup_string = rollup;\ncallback(rollup_string);\n",
          "name": "function"
        },
        {
          "type": "PLA-1366",
          "value": false,
          "name": "provide_composite_access"
        }
      ],
      "executionTime": 2.633550871,
      "executionNumber": 11,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "587c8547a344b45595c9a1af"
    },
    {
      "timestamp": "2017-01-17T09:21:34.000Z",
      "stackName": "AUDIT-AWS-RDS-TRETRTRE",
      "runId": "8c8ca9d3-73c3-4015-bb37-b68f977ca52d",
      "resourceType": "coreo_uni_util_notify",
      "resourceName": "advise-rds-to-tag-values",
      "resourceId": "d87d0d4f4a269ce4070b2fb08434009a19d6263ed2b34e3e5fbbcfd75dc9dbe2",
      "outputs": [
        {
          "value": "cc_587c847c7d2_advise-rds-to-tag-values",
          "name": "ec2_name"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-TRETRTRE",
      "inputs": [
        {
          "type": "choice",
          "value": "notify",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "[{\"type\":\"email\",\"send_on\":\"change\",\"allow_empty\":\"false\",\"payload_type\":\"html\",\"endpoint\":{\"to\":\"natalia@cloudcoreo.com\"},\"payload\":\"<h2>Composite name: audit-aws-rds</h2><h3>Plan name: tretrtre</h3><p>Number of violations: 2</p><div style=\\\"border:1px solid #6b6b6b;border-left-width:10px;font-family:sans-serif;color:#333333;max-width:700px;font-size: 14px;margin:20px 0;\\\">\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 15px;overflow: hidden;border-bottom:1px solid #d4d4d4;margin-bottom: 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<span style=\\\"font-size: 18px;font-weight: bold;line-height: 20px;float: left;\\\">\\n\\t\\t\\t\\t\\t\\t\\tRDS Instance Inventory\\n\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-left:20px;\\\">1 Resources</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px; \\\">Informational</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-right:20px;\\\">rds</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"width: 100%;float: left;line-height: 16px;\\\">Alert ID: rds-inventory</span>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 0 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Category</i>\\n\\t\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">Inventory</p>\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Description</i>\\n\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\t\\tThis rule performs an inventory on all RDS DB instances in the target AWS account.\\n\\t\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t<div style=\\\"background: #e2e2e2; padding: 15px 15px 2px;\\\">\\n\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Suggested Fix</i>\\n\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\tNone.\\n\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t<p></p>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: bold; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(16.666666666666668% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\">RDS Instance</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Region</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Engine Type</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Engine Version</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Instance Type</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Tags</div></div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: normal; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(16.666666666666668% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\"><a href='https://console.aws.amazon.com/rds/home?region=us-east-1#dbinstances:id=cc-581e59ffbd6-kubestg;sf=all'>cc-581e59ffbd6-kubestg</a></div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">us-east-1</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">mysql</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">5.6.29</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">db.t2.micro</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">coreo_owner, Name</div></div><div style=\\\"border:1px solid #e49530;border-left-width:10px;font-family:sans-serif;color:#333333;max-width:700px;font-size: 14px;margin:20px 0;\\\">\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 15px;overflow: hidden;border-bottom:1px solid #d4d4d4;margin-bottom: 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<span style=\\\"font-size: 18px;font-weight: bold;line-height: 20px;float: left;\\\">\\n\\t\\t\\t\\t\\t\\t\\tRDS short backup retention period\\n\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-left:20px;\\\">2 Resources</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px; \\\">Warning</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-right:20px;\\\">rds</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"width: 100%;float: left;line-height: 16px;\\\">Alert ID: rds-short-backup-retention-period</span>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 0 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Category</i>\\n\\t\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">Dataloss</p>\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Description</i>\\n\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\t\\tThe affected RDS database has a short backup retention period (less than 30 days).\\n\\t\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t<div style=\\\"background: #e2e2e2; padding: 15px 15px 2px;\\\">\\n\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Suggested Fix</i>\\n\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\tModify the backup retension period to increase it to greater than 30 days.\\n\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t<p><a href=http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html>CloudCoreo Knowledge Base</a></p>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: bold; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(25% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\">RDS Instance</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Backup Retention Period</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Region</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Tags</div></div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: normal; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(25% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\"><a href='https://console.aws.amazon.com/rds/home?region=us-east-1#dbinstances:id=cc-57980ce2d13-kubedev;sf=all'>cc-57980ce2d13-kubedev</a></div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">2</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">us-east-1</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">coreo_owner, Name</div></div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: normal; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(25% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\"><a href='https://console.aws.amazon.com/rds/home?region=us-east-1#dbinstances:id=cc-581e59ffbd6-kubestg;sf=all'>cc-581e59ffbd6-kubestg</a></div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">2</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">us-east-1</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">coreo_owner, Name</div></div>\",\"num_violations\":\"2\",\"num_instances\":\"0\"}]",
          "name": "notifiers"
        }
      ],
      "executionTime": 3.445416652,
      "executionNumber": 12,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "587c854aa344b45595c9a1b0"
    },
    {
      "timestamp": "2017-01-17T09:21:36.000Z",
      "stackName": null,
      "runId": "8c8ca9d3-73c3-4015-bb37-b68f977ca52d",
      "resourceType": "coreo_uni_util_notify",
      "resourceName": "advise-rds-rollup",
      "resourceId": "ROOT::AUDIT-AWS-RDS-TRETRTRE_advise-rds-rollup",
      "outputs": [],
      "namespace": "ROOT::AUDIT-AWS-RDS-TRETRTRE",
      "inputs": [
        {
          "type": "choice",
          "value": "nothing",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "email",
          "name": "type"
        },
        {
          "type": "PLA-1366",
          "value": "text",
          "name": "payload_type"
        },
        {
          "type": "PLA-1366",
          "value": "\ncomposite name: PLAN::stack_name\nplan name: PLAN::name\nCOMPOSITE::coreo_uni_util_jsrunner.tags-rollup-rds.return\n  ",
          "name": "payload"
        },
        {
          "type": "PLA-1366",
          "value": {
            "subject": "CloudCoreo rds advisor alerts on PLAN::stack_name :: PLAN::name",
            "to": "natalia@cloudcoreo.com"
          },
          "name": "endpoint"
        },
        {
          "type": "PLA-1366",
          "value": false,
          "name": "allow_empty"
        },
        {
          "type": "PLA-1366",
          "value": "change",
          "name": "send_on"
        }
      ],
      "executionTime": 0,
      "executionNumber": -1,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "587c854ca344b45595c9a1b1"
    },
    {
      "timestamp": "2017-01-17T09:21:35.000Z",
      "stackName": null,
      "runId": "8c8ca9d3-73c3-4015-bb37-b68f977ca52d",
      "resourceType": "coreo_uni_util_notify",
      "resourceName": "advise-rds-json",
      "resourceId": "ROOT::AUDIT-AWS-RDS-TRETRTRE_advise-rds-json",
      "outputs": [],
      "namespace": "ROOT::AUDIT-AWS-RDS-TRETRTRE",
      "inputs": [
        {
          "type": "choice",
          "value": "nothing",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "email",
          "name": "type"
        },
        {
          "type": "PLA-1366",
          "value": "json",
          "name": "payload_type"
        },
        {
          "type": "PLA-1366",
          "value": "{\"composite name\":\"PLAN::stack_name\",\n  \"plan name\":\"PLAN::name\",\n  \"number_of_checks\":\"COMPOSITE::coreo_aws_advisor_rds.advise-rds.number_checks\",\n  \"number_of_violations\":\"COMPOSITE::coreo_aws_advisor_rds.advise-rds.number_violations\",\n  \"number_violations_ignored\":\"COMPOSITE::coreo_aws_advisor_rds.advise-rds.number_ignored_violations\",\n  \"violations\": COMPOSITE::coreo_uni_util_jsrunner.jsrunner-process-suppression.report }",
          "name": "payload"
        },
        {
          "type": "PLA-1366",
          "value": {
            "subject": "CloudCoreo rds advisor alerts on PLAN::stack_name :: PLAN::name",
            "to": "natalia@cloudcoreo.com"
          },
          "name": "endpoint"
        },
        {
          "type": "PLA-1366",
          "value": false,
          "name": "allow_empty"
        },
        {
          "type": "PLA-1366",
          "value": "change",
          "name": "send_on"
        }
      ],
      "executionTime": 0,
      "executionNumber": -1,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "587c854da344b45595c9a1b2"
    },
    {
      "timestamp": "2017-01-17T09:21:23.000Z",
      "stackName": "AUDIT-AWS-RDS-TRETRTRE",
      "runId": "8c8ca9d3-73c3-4015-bb37-b68f977ca52d",
      "resourceType": "coreo_uni_util_jsrunner",
      "resourceName": "tags-to-notifiers-array-rds",
      "resourceId": "f2b883ecc0c1d2e944ec1ecf61596aaae8bc9aec0e3b44839074911ff0e0ff4d",
      "outputs": [
        {
          "value": "cc_587c847c7d2_tags-to-notifiers-array-rds",
          "name": "ec2_name"
        },
        {
          "value": "[{\"type\":\"email\",\"send_on\":\"change\",\"allow_empty\":\"false\",\"payload_type\":\"html\",\"endpoint\":{\"to\":\"natalia@cloudcoreo.com\"},\"payload\":\"<h2>Composite name: audit-aws-rds</h2><h3>Plan name: tretrtre</h3><p>Number of violations: 2</p><div style=\\\"border:1px solid #6b6b6b;border-left-width:10px;font-family:sans-serif;color:#333333;max-width:700px;font-size: 14px;margin:20px 0;\\\">\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 15px;overflow: hidden;border-bottom:1px solid #d4d4d4;margin-bottom: 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<span style=\\\"font-size: 18px;font-weight: bold;line-height: 20px;float: left;\\\">\\n\\t\\t\\t\\t\\t\\t\\tRDS Instance Inventory\\n\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-left:20px;\\\">1 Resources</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px; \\\">Informational</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-right:20px;\\\">rds</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"width: 100%;float: left;line-height: 16px;\\\">Alert ID: rds-inventory</span>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 0 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Category</i>\\n\\t\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">Inventory</p>\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Description</i>\\n\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\t\\tThis rule performs an inventory on all RDS DB instances in the target AWS account.\\n\\t\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t<div style=\\\"background: #e2e2e2; padding: 15px 15px 2px;\\\">\\n\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Suggested Fix</i>\\n\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\tNone.\\n\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t<p></p>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: bold; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(16.666666666666668% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\">RDS Instance</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Region</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Engine Type</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Engine Version</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Instance Type</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Tags</div></div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: normal; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(16.666666666666668% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\"><a href='https://console.aws.amazon.com/rds/home?region=us-east-1#dbinstances:id=cc-581e59ffbd6-kubestg;sf=all'>cc-581e59ffbd6-kubestg</a></div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">us-east-1</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">mysql</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">5.6.29</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">db.t2.micro</div><div style=\\\"  width:calc(16.666666666666668% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #6b6b6b ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">coreo_owner, Name</div></div><div style=\\\"border:1px solid #e49530;border-left-width:10px;font-family:sans-serif;color:#333333;max-width:700px;font-size: 14px;margin:20px 0;\\\">\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 15px;overflow: hidden;border-bottom:1px solid #d4d4d4;margin-bottom: 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<span style=\\\"font-size: 18px;font-weight: bold;line-height: 20px;float: left;\\\">\\n\\t\\t\\t\\t\\t\\t\\tRDS short backup retention period\\n\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-left:20px;\\\">2 Resources</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px; \\\">Warning</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"float: right;color:#6B6B6B;line-height: 20px;margin-right:20px;\\\">rds</span>\\n\\t\\t\\t\\t\\t\\t<span style=\\\"width: 100%;float: left;line-height: 16px;\\\">Alert ID: rds-short-backup-retention-period</span>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t<div style=\\\"padding: 0 15px;\\\">\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Category</i>\\n\\t\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">Dataloss</p>\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t<div>\\n\\t\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Description</i>\\n\\t\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\t\\tThe affected RDS database has a short backup retention period (less than 30 days).\\n\\t\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t<div style=\\\"background: #e2e2e2; padding: 15px 15px 2px;\\\">\\n\\t\\t\\t\\t\\t<i style=\\\"line-height: 18px;\\\">Suggested Fix</i>\\n\\t\\t\\t\\t\\t<p style=\\\"line-height:16px;margin:0 0 20px;\\\">\\n\\t\\t\\t\\t\\t\\tModify the backup retension period to increase it to greater than 30 days.\\n\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t<p><a href=http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html>CloudCoreo Knowledge Base</a></p>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: bold; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(25% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\">RDS Instance</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">Backup Retention Period</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Region</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">AWS Tags</div></div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: normal; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(25% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\"><a href='https://console.aws.amazon.com/rds/home?region=us-east-1#dbinstances:id=cc-57980ce2d13-kubedev;sf=all'>cc-57980ce2d13-kubedev</a></div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">2</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">us-east-1</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">coreo_owner, Name</div></div><div style=\\\"display:flex; flex-wrap: wrap; text-align: center; \\n\\t\\t\\t\\tfont-weight: normal; font-family:sans-serif;\\n\\t\\t\\t\\tcolor:#333333;max-width:1170px;font-size: 14px;\\\"><div style=\\\" width:calc(25% - 32px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ; \\n\\t\\t\\t\\t\\tborder-left-width:10px;padding: 10px;\\\"><a href='https://console.aws.amazon.com/rds/home?region=us-east-1#dbinstances:id=cc-581e59ffbd6-kubestg;sf=all'>cc-581e59ffbd6-kubestg</a></div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">2</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">us-east-1</div><div style=\\\"  width:calc(25% - 22px);\\n\\t\\t\\t\\t\\tborder: 1px solid #e49530 ;\\n\\t\\t\\t\\t\\tpadding: 10px;\\\">coreo_owner, Name</div></div>\",\"num_violations\":\"2\",\"num_instances\":\"0\"}]",
          "name": "return"
        },
        {
          "value": "#!/usr/bin/env node\nconst util = require('util')\n\nvar input = { \"composite name\":\"audit-aws-rds\",\n                \"plan name\":\"tretrtre\",\n                \"table\": {\"rds-short-backup-retention-period\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"Backup Retention Period\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.backup_retention_period+\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"AWS Tags\":\"__TAGS__\"},\"rds-no-auto-minor-version-upgrade\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"AWS Tags\":\"__TAGS__\"},\"rds-db-publicly-accessible\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"AWS Tags\":\"__TAGS__\"},\"rds-inventory\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"Engine Type\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.engine+\",\"Engine Version\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.engine_version+\",\"Instance Type\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.db_instance_class+\",\"AWS Tags\":\"__TAGS__\"}},\n                \"violations\": {\"cc-57980ce2d13-kubedev\":{\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}],\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\",\"suppressed\":true,\"suppressed_until\":\"2017-01-30T14:44Z\",\"suppression_expired\":false},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\",\"suppression_expired\":false,\"suppressed\":false}}},\"cc-581e59ffbd6-kubestg\":{\"tags\":[{\"value\":\"george+2@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubestg\",\"key\":\"Name\"}],\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\",\"suppression_expired\":false,\"suppressed\":false},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\",\"suppression_expired\":false,\"suppressed\":false}}}}};\n\nfunction coreoExport(variable, value) {\n    if (! /^[A-Za-z]+[A-Za-z0-9_-]*/.test(variable)) {\n        throw(`${variable} is not a valid variable name`);\n    }\n\n    console.log(`CC_EXPORT_OUTPUT_STARTS_HERE`);\n    console.log(`${variable}=${value}`);\n    console.log(`CC_EXPORT_OUTPUT_ENDS_HERE`);\n}\n\nfunction myfunc(json_input, callback) {\n\n\n\n\nconst JSON_INPUT = json_input;\nconst NO_OWNER_EMAIL = \"natalia@cloudcoreo.com\";\nconst OWNER_TAG = \"NOT_A_TAG\";\nconst ALLOW_EMPTY = \"false\";\nconst SEND_ON = \"change\";\nconst AUDIT_NAME = 'rds';\nconst TABLES = json_input['table'];\nconst SHOWN_NOT_SORTED_VIOLATIONS_COUNTER = false;\n\nconst WHAT_NEED_TO_SHOWN_ON_TABLE = {\n    OBJECT_ID: { headerName: 'AWS Object ID', isShown: true},\n    REGION: { headerName: 'Region', isShown: true },\n    AWS_CONSOLE: { headerName: 'AWS Console', isShown: true },\n    TAGS: { headerName: 'Tags', isShown: true },\n    AMI: { headerName: 'AMI', isShown: false },\n    KILL_SCRIPTS: { headerName: 'Kill Cmd', isShown: false }\n};\n\nconst VARIABLES = { NO_OWNER_EMAIL, OWNER_TAG, AUDIT_NAME,\n    WHAT_NEED_TO_SHOWN_ON_TABLE, ALLOW_EMPTY, SEND_ON,\n    undefined, undefined, SHOWN_NOT_SORTED_VIOLATIONS_COUNTER};\n\nconst CloudCoreoJSRunner = require('cloudcoreo-jsrunner-commons');\nconst AuditRDS = new CloudCoreoJSRunner(JSON_INPUT, VARIABLES, TABLES);\nconst notifiers = AuditRDS.getNotifiers();\ncallback(notifiers);\n\n}\n\nvar ret = myfunc(input, function (data) {\n    console.log('CC_USER_OUTPUT_STARTS_HERE');\n    if (\"json\" == \"json\") {\n      console.log(JSON.stringify(data));\n    } else {\n      console.log(data);\n    }\n    console.log('CC_USER_OUTPUT_ENDS_HERE');\n});\n",
          "name": "jsrunner_file"
        },
        {
          "value": "{\"name\":\"jsrunner\",\"description\":\"jsrunner\",\"engine\":\"node 6.6.0\",\"dependencies\": {\n\"cloudcoreo-jsrunner-commons\": \"1.5.3\"}}\n",
          "name": "packages_file"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-TRETRTRE",
      "inputs": [
        {
          "type": "choice",
          "value": "run",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "json",
          "name": "data_type"
        },
        {
          "type": "PLA-1366",
          "value": "{ \"composite name\":\"audit-aws-rds\",\n                \"plan name\":\"tretrtre\",\n                \"table\": {\"rds-short-backup-retention-period\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"Backup Retention Period\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.backup_retention_period+\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"AWS Tags\":\"__TAGS__\"},\"rds-no-auto-minor-version-upgrade\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"AWS Tags\":\"__TAGS__\"},\"rds-db-publicly-accessible\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"AWS Tags\":\"__TAGS__\"},\"rds-inventory\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"Engine Type\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.engine+\",\"Engine Version\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.engine_version+\",\"Instance Type\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.db_instance_class+\",\"AWS Tags\":\"__TAGS__\"}},\n                \"violations\": {\"cc-57980ce2d13-kubedev\":{\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}],\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\",\"suppressed\":true,\"suppressed_until\":\"2017-01-30T14:44Z\",\"suppression_expired\":false},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\",\"suppression_expired\":false,\"suppressed\":false}}},\"cc-581e59ffbd6-kubestg\":{\"tags\":[{\"value\":\"george+2@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubestg\",\"key\":\"Name\"}],\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\",\"suppression_expired\":false,\"suppressed\":false},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\",\"suppression_expired\":false,\"suppressed\":false}}}}}",
          "name": "json_input"
        },
        {
          "type": "PLA-1366",
          "value": "\n\n\n\nconst JSON_INPUT = json_input;\nconst NO_OWNER_EMAIL = \"natalia@cloudcoreo.com\";\nconst OWNER_TAG = \"NOT_A_TAG\";\nconst ALLOW_EMPTY = \"false\";\nconst SEND_ON = \"change\";\nconst AUDIT_NAME = 'rds';\nconst TABLES = json_input['table'];\nconst SHOWN_NOT_SORTED_VIOLATIONS_COUNTER = false;\n\nconst WHAT_NEED_TO_SHOWN_ON_TABLE = {\n    OBJECT_ID: { headerName: 'AWS Object ID', isShown: true},\n    REGION: { headerName: 'Region', isShown: true },\n    AWS_CONSOLE: { headerName: 'AWS Console', isShown: true },\n    TAGS: { headerName: 'Tags', isShown: true },\n    AMI: { headerName: 'AMI', isShown: false },\n    KILL_SCRIPTS: { headerName: 'Kill Cmd', isShown: false }\n};\n\nconst VARIABLES = { NO_OWNER_EMAIL, OWNER_TAG, AUDIT_NAME,\n    WHAT_NEED_TO_SHOWN_ON_TABLE, ALLOW_EMPTY, SEND_ON,\n    undefined, undefined, SHOWN_NOT_SORTED_VIOLATIONS_COUNTER};\n\nconst CloudCoreoJSRunner = require('cloudcoreo-jsrunner-commons');\nconst AuditRDS = new CloudCoreoJSRunner(JSON_INPUT, VARIABLES, TABLES);\nconst notifiers = AuditRDS.getNotifiers();\ncallback(notifiers);\n",
          "name": "function"
        },
        {
          "type": "PLA-1366",
          "value": false,
          "name": "provide_composite_access"
        },
        {
          "type": "PLA-1366",
          "value": [
            {
              "version": "1.5.3",
              "name": "cloudcoreo-jsrunner-commons"
            }
          ],
          "name": "packages"
        }
      ],
      "executionTime": 6.577973568,
      "executionNumber": 10,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "587c8540a344b45595c9a1ae"
    },
    {
      "timestamp": "2017-01-17T09:21:00.000Z",
      "stackName": "AUDIT-AWS-RDS-TRETRTRE",
      "runId": "8c8ca9d3-73c3-4015-bb37-b68f977ca52d",
      "resourceType": "coreo_uni_util_jsrunner",
      "resourceName": "jsrunner-process-suppression",
      "resourceId": "5df6f74326f250c302398bba7b0f81695f38c112dc63cba7dc59cd2507e10c57",
      "outputs": [
        {
          "value": "cc_587c847c7d2_jsrunner-process-suppression",
          "name": "ec2_name"
        },
        {
          "value": "{\"cc-57980ce2d13-kubedev\":{\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}],\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\",\"suppressed\":true,\"suppressed_until\":\"2017-01-30T14:44Z\",\"suppression_expired\":false},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\",\"suppression_expired\":false,\"suppressed\":false}}},\"cc-581e59ffbd6-kubestg\":{\"tags\":[{\"value\":\"george+2@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubestg\",\"key\":\"Name\"}],\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\",\"suppression_expired\":false,\"suppressed\":false},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\",\"suppression_expired\":false,\"suppressed\":false}}}}",
          "name": "return"
        },
        {
          "value": "#!/usr/bin/env node\nconst util = require('util')\n\nvar input = {\"composite name\":\"audit-aws-rds\",\"plan name\":\"tretrtre\",\"number_of_checks\":\"8\",\"number_of_violations\":\"2\",\"number_violations_ignored\":\"0\",\"regions\":\"[\\'us-east-1\\',\\'us-east-2\\',\\'us-west-1\\',\\'us-west-2\\',\\'eu-west-1\\']\",\"violations\":{\"cc-57980ce2d13-kubedev\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}]},\"cc-581e59ffbd6-kubestg\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+2@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubestg\",\"key\":\"Name\"}]}}};\n\nfunction coreoExport(variable, value) {\n    if (! /^[A-Za-z]+[A-Za-z0-9_-]*/.test(variable)) {\n        throw(`${variable} is not a valid variable name`);\n    }\n\n    console.log(`CC_EXPORT_OUTPUT_STARTS_HERE`);\n    console.log(`${variable}=${value}`);\n    console.log(`CC_EXPORT_OUTPUT_ENDS_HERE`);\n}\n\nfunction myfunc(json_input, callback) {\n  var fs = require('fs');\n  var yaml = require('js-yaml');\n  let suppression;\n  try {\n      suppression = yaml.safeLoad(fs.readFileSync('./suppression.yaml', 'utf8'));\n      console.log(suppression);\n  } catch (e) {\n      console.log(e);\n  }\n  coreoExport('suppression', JSON.stringify(suppression));\n  var violations = json_input.violations;\n  var result = {};\n    var file_date = null;\n    for (var violator_id in violations) {\n        result[violator_id] = {};\n        result[violator_id].tags = violations[violator_id].tags;\n        result[violator_id].violations = {}\n        //console.log(violator_id);\n        for (var rule_id in violations[violator_id].violations) {\n            console.log(\"object \" + violator_id + \" violates rule \" + rule_id);\n            is_violation = true;\n \n            result[violator_id].violations[rule_id] = violations[violator_id].violations[rule_id];\n            for (var suppress_rule_id in suppression) {\n                for (var suppress_violator_num in suppression[suppress_rule_id]) {\n                    for (var suppress_violator_id in suppression[suppress_rule_id][suppress_violator_num]) {\n                        file_date = null;\n                        var suppress_obj_id_time = suppression[suppress_rule_id][suppress_violator_num][suppress_violator_id];\n                        console.log(\" compare: \" + rule_id + \":\" + violator_id + \" <> \" + suppress_rule_id + \":\" + suppress_violator_id);\n                        if (rule_id === suppress_rule_id) {\n                            console.log(\"    have a suppression for rule: \" + rule_id);\n \n                            if (violator_id === suppress_violator_id) {\n                                var now_date = new Date();\n \n                                if (suppress_obj_id_time === \"\") {\n                                    suppress_obj_id_time = new Date();\n                                } else {\n                                    file_date = suppress_obj_id_time;\n                                    suppress_obj_id_time = file_date;\n                                }\n                                var rule_date = new Date(suppress_obj_id_time);\n                                if (isNaN(rule_date.getTime())) {\n                                    console.log(\"invalid date, setting expiration to time zero\");\n                                    rule_date = new Date(0);\n                                }\n \n                                if (now_date <= rule_date) {\n \n                                    console.log(\"    *** found violation to suppress: \" + violator_id);\n                                    is_violation = false;\n \n                                    result[violator_id].violations[rule_id][\"suppressed\"] = true;\n                                    if (file_date != null) {\n                                        result[violator_id].violations[rule_id][\"suppressed_until\"] = file_date;\n                                        result[violator_id].violations[rule_id][\"suppression_expired\"] = false;\n                                    }\n                                }\n                            }\n                        }\n                    }\n \n                }\n            }\n            if (is_violation) {\n                console.log(\"    +++ not suppressed\");\n \n                if (file_date !== null) {\n                    result[violator_id].violations[rule_id][\"suppressed_until\"] = file_date;\n                    result[violator_id].violations[rule_id][\"suppression_expired\"] = true;\n                } else {\n                    result[violator_id].violations[rule_id][\"suppression_expired\"] = false;\n                }\n                result[violator_id].violations[rule_id][\"suppressed\"] = false;\n            }\n        }\n    }\n \n    var rtn = result;\n  \n  var rtn = result;\n  \n  callback(result);\n\n}\n\nvar ret = myfunc(input, function (data) {\n    console.log('CC_USER_OUTPUT_STARTS_HERE');\n    if (\"json\" == \"json\") {\n      console.log(JSON.stringify(data));\n    } else {\n      console.log(data);\n    }\n    console.log('CC_USER_OUTPUT_ENDS_HERE');\n});\n",
          "name": "jsrunner_file"
        },
        {
          "value": "{\"name\":\"jsrunner\",\"description\":\"jsrunner\",\"engine\":\"node 6.6.0\",\"dependencies\": {\n\"js-yaml\": \"3.7.0\"}}\n",
          "name": "packages_file"
        },
        {
          "value": "{\"rds-short-backup-retention-period\":[{\"cc-57980ce2d13-kubedev\":\"2017-01-10T00:00Z\"}],\"rds-no-auto-minor-version-upgrade\":[{\"put-your-object-id-here-1\":\"\"},{\"put-your-object-id-here-2\":\"\"}],\"rds-db-publicly-accessible\":[{\"put-your-object-id-here\":\"\"}],\"rds-inventory\":[{\"cc-57980ce2d13-kubedev\":\"2017-01-30T14:44Z\"}]}\n",
          "name": "suppression"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-TRETRTRE",
      "inputs": [
        {
          "type": "choice",
          "value": "run",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "json",
          "name": "data_type"
        },
        {
          "type": "PLA-1366",
          "value": "{\"composite name\":\"audit-aws-rds\",\"plan name\":\"tretrtre\",\"number_of_checks\":\"8\",\"number_of_violations\":\"2\",\"number_violations_ignored\":\"0\",\"regions\":\"['us-east-1','us-east-2','us-west-1','us-west-2','eu-west-1']\",\"violations\":{\"cc-57980ce2d13-kubedev\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}]},\"cc-581e59ffbd6-kubestg\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+2@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubestg\",\"key\":\"Name\"}]}}}",
          "name": "json_input"
        },
        {
          "type": "PLA-1366",
          "value": "  var fs = require('fs');\n  var yaml = require('js-yaml');\n  let suppression;\n  try {\n      suppression = yaml.safeLoad(fs.readFileSync('./suppression.yaml', 'utf8'));\n      console.log(suppression);\n  } catch (e) {\n      console.log(e);\n  }\n  coreoExport('suppression', JSON.stringify(suppression));\n  var violations = json_input.violations;\n  var result = {};\n    var file_date = null;\n    for (var violator_id in violations) {\n        result[violator_id] = {};\n        result[violator_id].tags = violations[violator_id].tags;\n        result[violator_id].violations = {}\n        //console.log(violator_id);\n        for (var rule_id in violations[violator_id].violations) {\n            console.log(\"object \" + violator_id + \" violates rule \" + rule_id);\n            is_violation = true;\n \n            result[violator_id].violations[rule_id] = violations[violator_id].violations[rule_id];\n            for (var suppress_rule_id in suppression) {\n                for (var suppress_violator_num in suppression[suppress_rule_id]) {\n                    for (var suppress_violator_id in suppression[suppress_rule_id][suppress_violator_num]) {\n                        file_date = null;\n                        var suppress_obj_id_time = suppression[suppress_rule_id][suppress_violator_num][suppress_violator_id];\n                        console.log(\" compare: \" + rule_id + \":\" + violator_id + \" <> \" + suppress_rule_id + \":\" + suppress_violator_id);\n                        if (rule_id === suppress_rule_id) {\n                            console.log(\"    have a suppression for rule: \" + rule_id);\n \n                            if (violator_id === suppress_violator_id) {\n                                var now_date = new Date();\n \n                                if (suppress_obj_id_time === \"\") {\n                                    suppress_obj_id_time = new Date();\n                                } else {\n                                    file_date = suppress_obj_id_time;\n                                    suppress_obj_id_time = file_date;\n                                }\n                                var rule_date = new Date(suppress_obj_id_time);\n                                if (isNaN(rule_date.getTime())) {\n                                    console.log(\"invalid date, setting expiration to time zero\");\n                                    rule_date = new Date(0);\n                                }\n \n                                if (now_date <= rule_date) {\n \n                                    console.log(\"    *** found violation to suppress: \" + violator_id);\n                                    is_violation = false;\n \n                                    result[violator_id].violations[rule_id][\"suppressed\"] = true;\n                                    if (file_date != null) {\n                                        result[violator_id].violations[rule_id][\"suppressed_until\"] = file_date;\n                                        result[violator_id].violations[rule_id][\"suppression_expired\"] = false;\n                                    }\n                                }\n                            }\n                        }\n                    }\n \n                }\n            }\n            if (is_violation) {\n                console.log(\"    +++ not suppressed\");\n \n                if (file_date !== null) {\n                    result[violator_id].violations[rule_id][\"suppressed_until\"] = file_date;\n                    result[violator_id].violations[rule_id][\"suppression_expired\"] = true;\n                } else {\n                    result[violator_id].violations[rule_id][\"suppression_expired\"] = false;\n                }\n                result[violator_id].violations[rule_id][\"suppressed\"] = false;\n            }\n        }\n    }\n \n    var rtn = result;\n  \n  var rtn = result;\n  \n  callback(result);\n",
          "name": "function"
        },
        {
          "type": "PLA-1366",
          "value": true,
          "name": "provide_composite_access"
        },
        {
          "type": "PLA-1366",
          "value": [
            {
              "version": "3.7.0",
              "name": "js-yaml"
            }
          ],
          "name": "packages"
        }
      ],
      "executionTime": 9.188009844,
      "executionNumber": 7,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "587de1fe7c2e99b1ad6c4ab6"
    },
    {
      "timestamp": "2017-01-17T09:21:13.000Z",
      "stackName": "AUDIT-AWS-RDS-TRETRTRE",
      "runId": "8c8ca9d3-73c3-4015-bb37-b68f977ca52d",
      "resourceType": "coreo_uni_util_jsrunner",
      "resourceName": "jsrunner-process-table",
      "resourceId": "9d0166f105d28d8dc3d9e3088165c6629625b58d8fc6502f9f5dd3596d0476e9",
      "outputs": [
        {
          "value": "cc_587c847c7d2_jsrunner-process-table",
          "name": "ec2_name"
        },
        {
          "value": "{\"rds-short-backup-retention-period\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"Backup Retention Period\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.backup_retention_period+\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"AWS Tags\":\"__TAGS__\"},\"rds-no-auto-minor-version-upgrade\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"AWS Tags\":\"__TAGS__\"},\"rds-db-publicly-accessible\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"AWS Tags\":\"__TAGS__\"},\"rds-inventory\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"Engine Type\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.engine+\",\"Engine Version\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.engine_version+\",\"Instance Type\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.db_instance_class+\",\"AWS Tags\":\"__TAGS__\"}}",
          "name": "return"
        },
        {
          "value": "#!/usr/bin/env node\nconst util = require('util')\n\nvar input = {\"composite name\":\"audit-aws-rds\",\"plan name\":\"tretrtre\",\"number_of_checks\":\"8\",\"number_of_violations\":\"2\",\"number_violations_ignored\":\"0\",\"regions\":\"[\\'us-east-1\\',\\'us-east-2\\',\\'us-west-1\\',\\'us-west-2\\',\\'eu-west-1\\']\",\"violations\":{\"cc-57980ce2d13-kubedev\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}]},\"cc-581e59ffbd6-kubestg\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+2@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubestg\",\"key\":\"Name\"}]}}};\n\nfunction coreoExport(variable, value) {\n    if (! /^[A-Za-z]+[A-Za-z0-9_-]*/.test(variable)) {\n        throw(`${variable} is not a valid variable name`);\n    }\n\n    console.log(`CC_EXPORT_OUTPUT_STARTS_HERE`);\n    console.log(`${variable}=${value}`);\n    console.log(`CC_EXPORT_OUTPUT_ENDS_HERE`);\n}\n\nfunction myfunc(json_input, callback) {\n    var fs = require('fs');\n    var yaml = require('js-yaml');\n    try {\n        var table = yaml.safeLoad(fs.readFileSync('./table.yaml', 'utf8'));\n        console.log(table);\n    } catch (e) {\n        console.log(e);\n    }\n    coreoExport('table', JSON.stringify(table));\n    callback(table);\n\n}\n\nvar ret = myfunc(input, function (data) {\n    console.log('CC_USER_OUTPUT_STARTS_HERE');\n    if (\"json\" == \"json\") {\n      console.log(JSON.stringify(data));\n    } else {\n      console.log(data);\n    }\n    console.log('CC_USER_OUTPUT_ENDS_HERE');\n});\n",
          "name": "jsrunner_file"
        },
        {
          "value": "{\"name\":\"jsrunner\",\"description\":\"jsrunner\",\"engine\":\"node 6.6.0\",\"dependencies\": {\n\"js-yaml\": \"3.7.0\"}}\n",
          "name": "packages_file"
        },
        {
          "value": "{\"rds-short-backup-retention-period\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"Backup Retention Period\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.backup_retention_period+\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"AWS Tags\":\"__TAGS__\"},\"rds-no-auto-minor-version-upgrade\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"AWS Tags\":\"__TAGS__\"},\"rds-db-publicly-accessible\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"AWS Tags\":\"__TAGS__\"},\"rds-inventory\":{\"RDS Instance\":\"__OBJECT__~https://console.aws.amazon.com/rds/home?region=+__OBJECT__.violations.__RULE__.region+#dbinstances:id=__OBJECT__;sf=all\",\"AWS Region\":\"+__OBJECT__.violations.__RULE__.region+\",\"Engine Type\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.engine+\",\"Engine Version\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.engine_version+\",\"Instance Type\":\"+__OBJECT__.violations.__RULE__.violating_object.0.object.db_instance_class+\",\"AWS Tags\":\"__TAGS__\"}}\n",
          "name": "table"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS-TRETRTRE",
      "inputs": [
        {
          "type": "choice",
          "value": "run",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "json",
          "name": "data_type"
        },
        {
          "type": "PLA-1366",
          "value": "{\"composite name\":\"audit-aws-rds\",\"plan name\":\"tretrtre\",\"number_of_checks\":\"8\",\"number_of_violations\":\"2\",\"number_violations_ignored\":\"0\",\"regions\":\"['us-east-1','us-east-2','us-west-1','us-west-2','eu-west-1']\",\"violations\":{\"cc-57980ce2d13-kubedev\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-c90c96b4\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-57980ce2d13-kubedev\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1d\",\"preferred_backup_window\":\"03:42-04:12\",\"db_instance_identifier\":\"cc-57980ce2d13-kubedev\",\"endpoint\":{\"port\":3306,\"address\":\"cc-57980ce2d13-kubedev.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubedev\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T09:19:38Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-e41194c9\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-3d1da366\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ec9eeaa5\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-ff1ae199\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubedev]\",\"db_subnet_group_name\":\"cc-57980ce2d13-kubedev\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"fri:03:01-fri:03:31\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}]},\"cc-581e59ffbd6-kubestg\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].db_instance_identifier\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].backup_retention_period\",\"object\":{\"db_security_groups\":[],\"vpc_security_groups\":[{\"vpc_security_group_id\":\"sg-5325402e\",\"status\":\"active\"}],\"db_parameter_groups\":[{\"db_parameter_group_name\":\"cc-581e59ffbd6-kubestg\",\"parameter_apply_status\":\"in-sync\"}],\"read_replica_db_instance_identifiers\":[],\"option_group_memberships\":[{\"option_group_name\":\"default:mysql-5-6\",\"status\":\"in-sync\"}],\"status_infos\":[],\"allocated_storage\":25,\"availability_zone\":\"us-east-1c\",\"preferred_backup_window\":\"07:56-08:26\",\"db_instance_identifier\":\"cc-581e59ffbd6-kubestg\",\"endpoint\":{\"port\":3306,\"address\":\"cc-581e59ffbd6-kubestg.cgfflexed4cn.us-east-1.rds.amazonaws.com\"},\"engine\":\"mysql\",\"publicly_accessible\":false,\"engine_version\":\"5.6.29\",\"master_username\":\"admin\",\"db_name\":\"kubestg\",\"multi_az\":false,\"instance_create_time\":\"2016-11-28T10:00:34Z\",\"db_instance_class\":\"db.t2.micro\",\"db_subnet_group\":{\"subnets\":[{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-838df9ca\",\"subnet_availability_zone\":{\"name\":\"us-east-1d\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-a30fb1f8\",\"subnet_availability_zone\":{\"name\":\"us-east-1a\",\"provisioned_iops_capable\":false}},{\"subnet_status\":\"Active\",\"subnet_identifier\":\"subnet-ae26a383\",\"subnet_availability_zone\":{\"name\":\"us-east-1c\",\"provisioned_iops_capable\":false}}],\"subnet_group_status\":\"Complete\",\"vpc_id\":\"vpc-3309f255\",\"db_subnet_group_description\":\"Subnet Group Created by CloudCoreo for Db [kubestg]\",\"db_subnet_group_name\":\"cc-581e59ffbd6-kubestg\"},\"license_model\":\"general-public-license\",\"pending_modified_values\":null,\"preferred_maintenance_window\":\"sun:03:36-sun:04:06\",\"db_instance_status\":\"available\",\"backup_retention_period\":2,\"auto_minor_version_upgrade\":true,\"latest_restorable_time\":\"2017-01-17T09:15:00Z\"}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+2@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubestg\",\"key\":\"Name\"}]}}}",
          "name": "json_input"
        },
        {
          "type": "PLA-1366",
          "value": "    var fs = require('fs');\n    var yaml = require('js-yaml');\n    try {\n        var table = yaml.safeLoad(fs.readFileSync('./table.yaml', 'utf8'));\n        console.log(table);\n    } catch (e) {\n        console.log(e);\n    }\n    coreoExport('table', JSON.stringify(table));\n    callback(table);\n",
          "name": "function"
        },
        {
          "type": "PLA-1366",
          "value": true,
          "name": "provide_composite_access"
        },
        {
          "type": "PLA-1366",
          "value": [
            {
              "version": "3.7.0",
              "name": "js-yaml"
            }
          ],
          "name": "packages"
        }
      ],
      "executionTime": 9.264426185,
      "executionNumber": 8,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "587de20b7c2e99b1ad6c4ab7"
    }
  ],
  "numberOfResources": 13,
  "planRefreshIntervalInHours": 24,
  "lastExecutionTime": "2017-01-17T09:20:00.000Z",
  "engineState": "COMPLETED",
  "isEnabled": false
}