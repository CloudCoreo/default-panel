{
  "resourcesArray": [
    {
      "timestamp": "2017-01-20T05:00:08.000Z",
      "stackName": "AUDIT-AWS-RDS.GIT-45646456",
      "runId": "e8efc66f-c54e-4da2-8663-a3a92b4427cc",
      "resourceType": "coreo_aws_advisor_alert",
      "resourceName": "rds-inventory",
      "resourceId": "cfb06ce9f1288dd691c895f8146b2cf27e78cda6d465bb03b3bfd83af01105c7",
      "outputs": [
        {
          "value": "cc_588178c9962_rds-inventory",
          "name": "ec2_name"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS.GIT-45646456",
      "inputs": [
        {
          "type": "choice",
          "value": "define",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "RDS Instance Inventory",
          "name": "display_name"
        },
        {
          "type": "PLA-1366",
          "value": "object.db_instances.db_instance_identifier",
          "name": "id_map"
        },
        {
          "type": "PLA-1366",
          "value": "rds",
          "name": "service"
        },
        {
          "type": "PLA-1366",
          "value": [
            "(?-mix:)"
          ],
          "name": "alert_when"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances"
          ],
          "name": "objectives"
        },
        {
          "type": "PLA-1366",
          "value": "Informational",
          "name": "level"
        },
        {
          "type": "PLA-1366",
          "value": [
            "=~"
          ],
          "name": "operators"
        },
        {
          "type": "PLA-1366",
          "value": "This rule performs an inventory on all RDS DB instances in the target AWS account.",
          "name": "description"
        },
        {
          "type": "PLA-1366",
          "value": "Inventory",
          "name": "category"
        },
        {
          "type": "PLA-1366",
          "value": "None.",
          "name": "suggested_action"
        },
        {
          "type": "PLA-1366",
          "value": [],
          "name": "call_modifiers"
        },
        {
          "type": "PLA-1366",
          "value": [
            "object.db_instances.db_instance_identifier"
          ],
          "name": "audit_objects"
        },
        {
          "type": "PLA-1366",
          "value": false,
          "name": "include_violations_in_count"
        }
      ],
      "executionTime": 8.608256184,
      "executionNumber": 1,
      "engineStatus": "OK",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "5881793ab718f26bebe51d2a"
    },
    {
      "timestamp": "2017-01-20T05:00:12.000Z",
      "stackName": "AUDIT-AWS-RDS.GIT-45646456",
      "runId": "e8efc66f-c54e-4da2-8663-a3a92b4427cc",
      "resourceType": "coreo_aws_advisor_alert",
      "resourceName": "rds-short-backup-retention-period",
      "resourceId": "69bb8f14bd728bae764bba1c857e5106be7a801cd864790cd63d8dc1891040b9",
      "outputs": [
        {
          "value": "cc_588178c9962_rds-short-backup-retention-period",
          "name": "ec2_name"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS.GIT-45646456",
      "inputs": [
        {
          "type": "choice",
          "value": "define",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "RDS short backup retention period",
          "name": "display_name"
        },
        {
          "type": "PLA-1366",
          "value": "object.db_instances.db_instance_identifier",
          "name": "id_map"
        },
        {
          "type": "PLA-1366",
          "value": "rds",
          "name": "service"
        },
        {
          "type": "PLA-1366",
          "value": [
            30
          ],
          "name": "alert_when"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances"
          ],
          "name": "objectives"
        },
        {
          "type": "PLA-1366",
          "value": "http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html",
          "name": "link"
        },
        {
          "type": "PLA-1366",
          "value": "Warning",
          "name": "level"
        },
        {
          "type": "PLA-1366",
          "value": [
            "<"
          ],
          "name": "operators"
        },
        {
          "type": "PLA-1366",
          "value": "The affected RDS database has a short backup retention period (less than 30 days).",
          "name": "description"
        },
        {
          "type": "PLA-1366",
          "value": "Dataloss",
          "name": "category"
        },
        {
          "type": "PLA-1366",
          "value": "Modify the backup retension period to increase it to greater than 30 days.",
          "name": "suggested_action"
        },
        {
          "type": "PLA-1366",
          "value": [],
          "name": "call_modifiers"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances.backup_retention_period"
          ],
          "name": "audit_objects"
        },
        {
          "type": "PLA-1366",
          "value": true,
          "name": "include_violations_in_count"
        }
      ],
      "executionTime": 1.265047695,
      "executionNumber": 2,
      "engineStatus": "OK",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "5881793db718f26bebe51d2b"
    },
    {
      "timestamp": "2017-01-20T05:00:14.000Z",
      "stackName": "AUDIT-AWS-RDS.GIT-45646456",
      "runId": "e8efc66f-c54e-4da2-8663-a3a92b4427cc",
      "resourceType": "coreo_aws_advisor_alert",
      "resourceName": "rds-no-auto-minor-version-upgrade",
      "resourceId": "4d44b1eab7d82001e034a95c1301c448ac051cd88f53c5433709fc4b1f618632",
      "outputs": [
        {
          "value": "cc_588178c9962_rds-no-auto-minor-version-upgrade",
          "name": "ec2_name"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS.GIT-45646456",
      "inputs": [
        {
          "type": "choice",
          "value": "define",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "RDS not set to automatically upgrade",
          "name": "display_name"
        },
        {
          "type": "PLA-1366",
          "value": "object.db_instances.db_instance_identifier",
          "name": "id_map"
        },
        {
          "type": "PLA-1366",
          "value": "rds",
          "name": "service"
        },
        {
          "type": "PLA-1366",
          "value": [
            false
          ],
          "name": "alert_when"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances"
          ],
          "name": "objectives"
        },
        {
          "type": "PLA-1366",
          "value": "http://kb.cloudcoreo.com/mydoc_rds-no-auto-minor-version-upgrade.html",
          "name": "link"
        },
        {
          "type": "PLA-1366",
          "value": "Critical",
          "name": "level"
        },
        {
          "type": "PLA-1366",
          "value": [
            "=="
          ],
          "name": "operators"
        },
        {
          "type": "PLA-1366",
          "value": "RDS is not set to automatically upgrade minor versions on your database instance.",
          "name": "description"
        },
        {
          "type": "PLA-1366",
          "value": "Reliability",
          "name": "category"
        },
        {
          "type": "PLA-1366",
          "value": "Consider whether you would like AWS to automatically upgrade minor versions on your database instance. Modify your settings to allow minor version upgrades if possible.",
          "name": "suggested_action"
        },
        {
          "type": "PLA-1366",
          "value": [],
          "name": "call_modifiers"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances.auto_minor_version_upgrade"
          ],
          "name": "audit_objects"
        },
        {
          "type": "PLA-1366",
          "value": true,
          "name": "include_violations_in_count"
        }
      ],
      "executionTime": 1.341593415,
      "executionNumber": 3,
      "engineStatus": "OK",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "5881793fb718f26bebe51d2c"
    },
    {
      "timestamp": "2017-01-20T05:00:16.000Z",
      "stackName": "AUDIT-AWS-RDS.GIT-45646456",
      "runId": "e8efc66f-c54e-4da2-8663-a3a92b4427cc",
      "resourceType": "coreo_aws_advisor_alert",
      "resourceName": "rds-db-publicly-accessible",
      "resourceId": "2e0f1ec82a3f34f853a7cd47eba9f78c54d4e06e13f9eb86c9fac707e6ad3019",
      "outputs": [
        {
          "value": "cc_588178c9962_rds-db-publicly-accessible",
          "name": "ec2_name"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS.GIT-45646456",
      "inputs": [
        {
          "type": "choice",
          "value": "define",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "RDS is publicly accessible to the world",
          "name": "display_name"
        },
        {
          "type": "PLA-1366",
          "value": "object.db_instances.db_instance_identifier",
          "name": "id_map"
        },
        {
          "type": "PLA-1366",
          "value": "rds",
          "name": "service"
        },
        {
          "type": "PLA-1366",
          "value": [
            true
          ],
          "name": "alert_when"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances"
          ],
          "name": "objectives"
        },
        {
          "type": "PLA-1366",
          "value": "http://kb.cloudcoreo.com/mydoc_rds-db-publicly-accessible.html",
          "name": "link"
        },
        {
          "type": "PLA-1366",
          "value": "Critical",
          "name": "level"
        },
        {
          "type": "PLA-1366",
          "value": [
            "=="
          ],
          "name": "operators"
        },
        {
          "type": "PLA-1366",
          "value": "The affected RDS database is publicly accessible to the world.",
          "name": "description"
        },
        {
          "type": "PLA-1366",
          "value": "Security",
          "name": "category"
        },
        {
          "type": "PLA-1366",
          "value": "Consider whether the affected RDS database should be publicly accessible to the world. If not, modify the option which enables your RDS database to become publicly accessible.",
          "name": "suggested_action"
        },
        {
          "type": "PLA-1366",
          "value": [],
          "name": "call_modifiers"
        },
        {
          "type": "PLA-1366",
          "value": [
            "db_instances.publicly_accessible"
          ],
          "name": "audit_objects"
        },
        {
          "type": "PLA-1366",
          "value": true,
          "name": "include_violations_in_count"
        }
      ],
      "executionTime": 1.266631197,
      "executionNumber": 4,
      "engineStatus": "OK",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "58817942b718f26bebe51d2d"
    },
    {
      "timestamp": "2017-01-20T05:00:29.000Z",
      "stackName": "AUDIT-AWS-RDS.GIT-45646456",
      "runId": "e8efc66f-c54e-4da2-8663-a3a92b4427cc",
      "resourceType": "coreo_aws_advisor_rds",
      "resourceName": "advise-rds",
      "resourceId": "847ebd34f078484cb4d8b20ee27d571a2ab396c27ed294b2dbbb95b622538f50",
      "outputs": [
        {
          "value": "cc_588178c9962_advise-rds",
          "name": "ec2_name"
        },
        {
          "value": 0,
          "name": "number_ignored_violations"
        },
        {
          "value": 2,
          "name": "number_violations"
        },
        {
          "value": 8,
          "name": "number_checks"
        },
        {
          "value": "{\"cc-57980ce2d13-kubedev\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].db_instance_identifier\",\"object\":{\"truncated\":{\"object_key\":\"e8efc66f-c54e-4da2-8663-a3a92b4427cc/847ebd34f078484cb4d8b20ee27d571a2ab396c27ed294b2dbbb95b622538f50/51d04bcb5e49f640700a96ed7ea3a5419a864c3b\",\"object_size\":1760}}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[0].backup_retention_period\",\"object\":{\"truncated\":{\"object_key\":\"e8efc66f-c54e-4da2-8663-a3a92b4427cc/847ebd34f078484cb4d8b20ee27d571a2ab396c27ed294b2dbbb95b622538f50/51d04bcb5e49f640700a96ed7ea3a5419a864c3b\",\"object_size\":1760}}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+1@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubedev\",\"key\":\"Name\"}]},\"cc-581e59ffbd6-kubestg\":{\"violations\":{\"rds-inventory\":{\"service\":\"rds\",\"display_name\":\"RDS Instance Inventory\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].db_instance_identifier\",\"object\":{\"truncated\":{\"object_key\":\"e8efc66f-c54e-4da2-8663-a3a92b4427cc/847ebd34f078484cb4d8b20ee27d571a2ab396c27ed294b2dbbb95b622538f50/b9b41f9c6278b6ec353edce806f74c4962e18b00\",\"object_size\":1760}}}],\"description\":\"This rule performs an inventory on all RDS DB instances in the target AWS account.\",\"category\":\"Inventory\",\"suggested_action\":\"None.\",\"level\":\"Informational\",\"include_violations_in_count\":false,\"region\":\"us-east-1\"},\"rds-short-backup-retention-period\":{\"service\":\"rds\",\"display_name\":\"RDS short backup retention period\",\"violating_object\":[{\"place\":\"db_instances:db_instances[1].backup_retention_period\",\"object\":{\"truncated\":{\"object_key\":\"e8efc66f-c54e-4da2-8663-a3a92b4427cc/847ebd34f078484cb4d8b20ee27d571a2ab396c27ed294b2dbbb95b622538f50/b9b41f9c6278b6ec353edce806f74c4962e18b00\",\"object_size\":1760}}}],\"description\":\"The affected RDS database has a short backup retention period (less than 30 days).\",\"category\":\"Dataloss\",\"suggested_action\":\"Modify the backup retension period to increase it to greater than 30 days.\",\"level\":\"Warning\",\"link\":\"http://kb.cloudcoreo.com/mydoc_rds-short-backup-retention-period.html\",\"include_violations_in_count\":true,\"region\":\"us-east-1\"}},\"tags\":[{\"value\":\"george+2@cloudcoreo.com\",\"key\":\"coreo_owner\"},{\"value\":\"kubestg\",\"key\":\"Name\"}]}}",
          "name": "report"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS.GIT-45646456",
      "inputs": [
        {
          "type": "choice",
          "value": "advise",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": [
            "us-east-1",
            "us-east-2",
            "us-west-1",
            "us-west-2",
            "eu-west-1"
          ],
          "name": "regions"
        },
        {
          "type": "PLA-1366",
          "value": [
            "rds-short-backup-retention-period",
            "rds-no-auto-minor-version-upgrade",
            "rds-db-publicly-accessible",
            "rds-inventory"
          ],
          "name": "alerts"
        }
      ],
      "executionTime": 9.569667302,
      "executionNumber": 5,
      "engineStatus": "OK",
      "dataType": "ADVISOR_RESOURCE",
      "_id": "5881794fb718f26bebe51d2e"
    },
    {
      "timestamp": "2017-01-20T05:00:40.000Z",
      "stackName": "AUDIT-AWS-RDS.GIT-45646456",
      "runId": "e8efc66f-c54e-4da2-8663-a3a92b4427cc",
      "resourceType": "coreo_uni_util_jsrunner",
      "resourceName": "rds-aggregate",
      "resourceId": "5831c38297f21f065acd3358127594f87fc3f62cf72e07f98c070d9f690bc562",
      "outputs": [
        {
          "value": "cc_588178c9962_rds-aggregate",
          "name": "ec2_name"
        },
        {
          "value": {
            "truncated": {
              "object_size": 10436,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/5831c38297f21f065acd3358127594f87fc3f62cf72e07f98c070d9f690bc562/364c6f5d5401967c75d4000a1391e4e723d47e22"
            }
          },
          "name": "return"
        },
        {
          "value": {
            "truncated": {
              "object_size": 11598,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/5831c38297f21f065acd3358127594f87fc3f62cf72e07f98c070d9f690bc562/65fce0c842f40d29900190ec3f180cd50e924ac9"
            }
          },
          "name": "jsrunner_file"
        },
        {
          "value": "{\"name\":\"jsrunner\",\"description\":\"jsrunner\",\"engine\":\"node 6.6.0\",\"dependencies\": {\n}}\n",
          "name": "packages_file"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS.GIT-45646456",
      "inputs": [
        {
          "type": "choice",
          "value": "run",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "json",
          "name": "data_type"
        },
        {
          "type": "PLA-1366",
          "value": {
            "truncated": {
              "object_size": 10378,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/5831c38297f21f065acd3358127594f87fc3f62cf72e07f98c070d9f690bc562/e1b899bea2c6d74760dfc09001bdd0ce100c3ef7"
            }
          },
          "name": "json_input"
        },
        {
          "type": "PLA-1366",
          "value": "\nvar_regions = \"['us-east-1','us-east-2','us-west-1','us-west-2','eu-west-1']\";\n\nvar result = {};\nresult['composite name'] = json_input['composite name'];\nresult['plan name'] = json_input['plan name'];\nresult['number_of_checks'] = json_input['number_of_checks'];\nresult['number_of_violations'] = json_input['number_of_violations'];\nresult['number_violations_ignored'] = json_input['number_violations_ignored'];\nresult['regions'] = var_regions;\nresult['violations'] = json_input['violations'];\n\ncallback(result);\n",
          "name": "function"
        },
        {
          "type": "PLA-1366",
          "value": false,
          "name": "provide_composite_access"
        }
      ],
      "executionTime": 4.872632652,
      "executionNumber": 6,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "58817958b718f26bebe51d2f"
    },
    {
      "timestamp": "2017-01-20T05:01:17.000Z",
      "stackName": "AUDIT-AWS-RDS.GIT-45646456",
      "runId": "e8efc66f-c54e-4da2-8663-a3a92b4427cc",
      "resourceType": "coreo_uni_util_jsrunner",
      "resourceName": "tags-to-notifiers-array-rds",
      "resourceId": "12dc2ab45e69cc4ddb2aff5ea7545191d1bd844c4afbf0a99e0accd8e6f845d9",
      "outputs": [
        {
          "value": "cc_588178c9962_tags-to-notifiers-array-rds",
          "name": "ec2_name"
        },
        {
          "value": {
            "truncated": {
              "object_size": 7197,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/12dc2ab45e69cc4ddb2aff5ea7545191d1bd844c4afbf0a99e0accd8e6f845d9/ee73e90d879cdafcaf41bf361039655d20447aa9"
            }
          },
          "name": "return"
        },
        {
          "value": {
            "truncated": {
              "object_size": 13861,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/12dc2ab45e69cc4ddb2aff5ea7545191d1bd844c4afbf0a99e0accd8e6f845d9/1af3518fc4c1598c2f7c300b9480a6a48b008459"
            }
          },
          "name": "jsrunner_file"
        },
        {
          "value": "{\"name\":\"jsrunner\",\"description\":\"jsrunner\",\"engine\":\"node 6.6.0\",\"dependencies\": {\n\"cloudcoreo-jsrunner-commons\": \"1.6.0\"}}\n",
          "name": "packages_file"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS.GIT-45646456",
      "inputs": [
        {
          "type": "choice",
          "value": "run",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "json",
          "name": "data_type"
        },
        {
          "type": "PLA-1366",
          "value": {
            "truncated": {
              "object_size": 12099,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/12dc2ab45e69cc4ddb2aff5ea7545191d1bd844c4afbf0a99e0accd8e6f845d9/75629dafb61080fd62cec7c03351e433cc29ed43"
            }
          },
          "name": "json_input"
        },
        {
          "type": "PLA-1366",
          "value": {
            "truncated": {
              "object_size": 1071,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/12dc2ab45e69cc4ddb2aff5ea7545191d1bd844c4afbf0a99e0accd8e6f845d9/f5f790e718dd24c159d0edbf9814685b0d6521d6"
            }
          },
          "name": "function"
        },
        {
          "type": "PLA-1366",
          "value": false,
          "name": "provide_composite_access"
        },
        {
          "type": "PLA-1366",
          "value": [
            {
              "version": "1.6.0",
              "name": "cloudcoreo-jsrunner-commons"
            }
          ],
          "name": "packages"
        }
      ],
      "executionTime": 3.917607289,
      "executionNumber": 10,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "5881797db718f26bebe51d32"
    },
    {
      "timestamp": "2017-01-20T05:01:26.000Z",
      "stackName": "AUDIT-AWS-RDS.GIT-45646456",
      "runId": "e8efc66f-c54e-4da2-8663-a3a92b4427cc",
      "resourceType": "coreo_uni_util_jsrunner",
      "resourceName": "tags-rollup-rds",
      "resourceId": "a592b278e8407eef66bf826aaf644eb3bf03f34a93ab73929e530ffcab98e90f",
      "outputs": [
        {
          "value": "cc_588178c9962_tags-rollup-rds",
          "name": "ec2_name"
        },
        {
          "value": "number of Violations: 0\nRollup\nrecipient: sdsdsfsdf - nViolations: 0",
          "name": "return"
        },
        {
          "value": {
            "truncated": {
              "object_size": 8529,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/a592b278e8407eef66bf826aaf644eb3bf03f34a93ab73929e530ffcab98e90f/e9c2652aa9e921272ca2a9abd9751892cd4d9120"
            }
          },
          "name": "jsrunner_file"
        },
        {
          "value": "{\"name\":\"jsrunner\",\"description\":\"jsrunner\",\"engine\":\"node 6.6.0\",\"dependencies\": {\n}}\n",
          "name": "packages_file"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS.GIT-45646456",
      "inputs": [
        {
          "type": "choice",
          "value": "run",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "text",
          "name": "data_type"
        },
        {
          "type": "PLA-1366",
          "value": {
            "truncated": {
              "object_size": 7197,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/a592b278e8407eef66bf826aaf644eb3bf03f34a93ab73929e530ffcab98e90f/ee73e90d879cdafcaf41bf361039655d20447aa9"
            }
          },
          "name": "json_input"
        },
        {
          "type": "PLA-1366",
          "value": "var rollup_string = \"\";\nlet rollup = '';\nlet emailText = '';\nlet numberOfViolations = 0;\nfor (var entry=0; entry < json_input.length; entry++) {\n    if (json_input[entry]['endpoint']['to'].length) {\n        numberOfViolations += parseInt(json_input[entry]['num_violations']);\n        emailText += \"recipient: \" + json_input[entry]['endpoint']['to'] + \" - \" + \"nViolations: \" + json_input[entry]['num_violations'] + \"\\n\";\n    }\n}\n\nrollup += 'number of Violations: ' + numberOfViolations + \"\\n\";\nrollup += 'Rollup' + \"\\n\";\nrollup += emailText;\n\nrollup_string = rollup;\ncallback(rollup_string);\n",
          "name": "function"
        },
        {
          "type": "PLA-1366",
          "value": false,
          "name": "provide_composite_access"
        }
      ],
      "executionTime": 2.57428103,
      "executionNumber": 11,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "58817983b718f26bebe51d33"
    },
    {
      "timestamp": "2017-01-20T05:01:34.000Z",
      "stackName": null,
      "runId": "e8efc66f-c54e-4da2-8663-a3a92b4427cc",
      "resourceType": "coreo_uni_util_notify",
      "resourceName": "advise-rds-json",
      "resourceId": "ROOT::AUDIT-AWS-RDS.GIT-45646456_advise-rds-json",
      "outputs": [],
      "namespace": "ROOT::AUDIT-AWS-RDS.GIT-45646456",
      "inputs": [
        {
          "type": "choice",
          "value": "nothing",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "email",
          "name": "type"
        },
        {
          "type": "PLA-1366",
          "value": "json",
          "name": "payload_type"
        },
        {
          "type": "PLA-1366",
          "value": "{\"composite name\":\"PLAN::stack_name\",\n  \"plan name\":\"PLAN::name\",\n  \"number_of_checks\":\"COMPOSITE::coreo_aws_advisor_rds.advise-rds.number_checks\",\n  \"number_of_violations\":\"COMPOSITE::coreo_aws_advisor_rds.advise-rds.number_violations\",\n  \"number_violations_ignored\":\"COMPOSITE::coreo_aws_advisor_rds.advise-rds.number_ignored_violations\",\n  \"violations\": COMPOSITE::coreo_uni_util_jsrunner.jsrunner-process-suppression.report }",
          "name": "payload"
        },
        {
          "type": "PLA-1366",
          "value": {
            "subject": "CloudCoreo rds advisor alerts on PLAN::stack_name :: PLAN::name",
            "to": "sdsdsfsdf"
          },
          "name": "endpoint"
        },
        {
          "type": "PLA-1366",
          "value": false,
          "name": "allow_empty"
        },
        {
          "type": "PLA-1366",
          "value": "change",
          "name": "send_on"
        }
      ],
      "executionTime": 0,
      "executionNumber": -1,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "5881798ab718f26bebe51d34"
    },
    {
      "timestamp": "2017-01-20T05:01:34.000Z",
      "stackName": "audit-aws-rds.git-45646456",
      "runId": "e8efc66f-c54e-4da2-8663-a3a92b4427cc",
      "resourceType": "coreo_uni_util_notify",
      "resourceName": "advise-rds-to-tag-values",
      "resourceId": "9e89bd1e1ab6cc575b0d6f4a9c92d9020308173a3c9def888c11d2c93b525cde",
      "outputs": [
        {
          "value": {
            "error_message": "Missing final '@domain'",
            "error_type": "AWS::SimpleEmailService::Errors::InvalidParameterValue",
            "resource_error": "action :notify on coreo_uni_util_notify[advise-rds-to-tag-values]"
          },
          "name": "error"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS.GIT-45646456",
      "inputs": [
        {
          "type": "choice",
          "value": "notify",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": {
            "truncated": {
              "object_size": 7197,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/9e89bd1e1ab6cc575b0d6f4a9c92d9020308173a3c9def888c11d2c93b525cde/ee73e90d879cdafcaf41bf361039655d20447aa9"
            }
          },
          "name": "notifiers"
        }
      ],
      "executionTime": 4.305424329,
      "executionNumber": 12,
      "engineStatus": "PROVIDER_ERROR",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "5881798bb718f26bebe51d35"
    },
    {
      "timestamp": "2017-01-20T05:00:54.000Z",
      "stackName": "AUDIT-AWS-RDS.GIT-45646456",
      "runId": "e8efc66f-c54e-4da2-8663-a3a92b4427cc",
      "resourceType": "coreo_uni_util_jsrunner",
      "resourceName": "jsrunner-process-suppression-rds",
      "resourceId": "38b074bc697db673e73707f4ec8d35b6332342d0081fc42eab2ad12d6281bd49",
      "outputs": [
        {
          "value": "cc_588178c9962_jsrunner-process-suppression-rds",
          "name": "ec2_name"
        },
        {
          "value": {
            "truncated": {
              "object_size": 10467,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/38b074bc697db673e73707f4ec8d35b6332342d0081fc42eab2ad12d6281bd49/b90bbef9b79599f345799ba80fe87bf571a6121b"
            }
          },
          "name": "return"
        },
        {
          "value": {
            "truncated": {
              "object_size": 14436,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/38b074bc697db673e73707f4ec8d35b6332342d0081fc42eab2ad12d6281bd49/62b0b31172bc89b8734ef44e18f1c3f73741aee1"
            }
          },
          "name": "jsrunner_file"
        },
        {
          "value": "{\"name\":\"jsrunner\",\"description\":\"jsrunner\",\"engine\":\"node 6.6.0\",\"dependencies\": {\n\"js-yaml\": \"3.7.0\"}}\n",
          "name": "packages_file"
        },
        {
          "value": "{\"rds-short-backup-retention-period\":[{\"cc-57980ce2d13-kubedev\":\"2017-01-30T00:00Z\"},{\"cc-581e59ffbd6-kubestg\":\"2017-01-30T00:00Z\"}]}\n",
          "name": "suppression"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS.GIT-45646456",
      "inputs": [
        {
          "type": "choice",
          "value": "run",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "json",
          "name": "data_type"
        },
        {
          "type": "PLA-1366",
          "value": {
            "truncated": {
              "object_size": 10436,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/38b074bc697db673e73707f4ec8d35b6332342d0081fc42eab2ad12d6281bd49/364c6f5d5401967c75d4000a1391e4e723d47e22"
            }
          },
          "name": "json_input"
        },
        {
          "type": "PLA-1366",
          "value": {
            "truncated": {
              "object_size": 3289,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/38b074bc697db673e73707f4ec8d35b6332342d0081fc42eab2ad12d6281bd49/8b4bd8b0bac317a7797c1718430876d473cd1488"
            }
          },
          "name": "function"
        },
        {
          "type": "PLA-1366",
          "value": true,
          "name": "provide_composite_access"
        },
        {
          "type": "PLA-1366",
          "value": [
            {
              "version": "3.7.0",
              "name": "js-yaml"
            }
          ],
          "name": "packages"
        }
      ],
      "executionTime": 6.389803472,
      "executionNumber": 7,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "58819709b718f26bebe51d36"
    },
    {
      "timestamp": "2017-01-20T05:01:07.000Z",
      "stackName": "AUDIT-AWS-RDS.GIT-45646456",
      "runId": "e8efc66f-c54e-4da2-8663-a3a92b4427cc",
      "resourceType": "coreo_uni_util_jsrunner",
      "resourceName": "jsrunner-process-table-rds",
      "resourceId": "7d31d015de2ced9d5b9b3164d9e127bdf7e6fbdb45dc09559b466ab637a1d2c4",
      "outputs": [
        {
          "value": "cc_588178c9962_jsrunner-process-table-rds",
          "name": "ec2_name"
        },
        {
          "value": {
            "truncated": {
              "object_size": 1481,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/7d31d015de2ced9d5b9b3164d9e127bdf7e6fbdb45dc09559b466ab637a1d2c4/a7d5fbad896e21baf15dbbb885548ae4c487d9d7"
            }
          },
          "name": "return"
        },
        {
          "value": {
            "truncated": {
              "object_size": 11400,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/7d31d015de2ced9d5b9b3164d9e127bdf7e6fbdb45dc09559b466ab637a1d2c4/d55f2a0990f92305d8ab913eede36b6dffae5a62"
            }
          },
          "name": "jsrunner_file"
        },
        {
          "value": "{\"name\":\"jsrunner\",\"description\":\"jsrunner\",\"engine\":\"node 6.6.0\",\"dependencies\": {\n\"js-yaml\": \"3.7.0\"}}\n",
          "name": "packages_file"
        },
        {
          "value": {
            "truncated": {
              "object_size": 1483,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/7d31d015de2ced9d5b9b3164d9e127bdf7e6fbdb45dc09559b466ab637a1d2c4/a10714ec5d6e141acbcde31d5d742aaa26de490f"
            }
          },
          "name": "table"
        }
      ],
      "namespace": "ROOT::AUDIT-AWS-RDS.GIT-45646456",
      "inputs": [
        {
          "type": "choice",
          "value": "run",
          "name": "action"
        },
        {
          "type": "PLA-1366",
          "value": "json",
          "name": "data_type"
        },
        {
          "type": "PLA-1366",
          "value": {
            "truncated": {
              "object_size": 10436,
              "object_key": "e8efc66f-c54e-4da2-8663-a3a92b4427cc/7d31d015de2ced9d5b9b3164d9e127bdf7e6fbdb45dc09559b466ab637a1d2c4/364c6f5d5401967c75d4000a1391e4e723d47e22"
            }
          },
          "name": "json_input"
        },
        {
          "type": "PLA-1366",
          "value": "    var fs = require('fs');\n    var yaml = require('js-yaml');\n    try {\n        var table = yaml.safeLoad(fs.readFileSync('./table.yaml', 'utf8'));\n    } catch (e) {\n    }\n    coreoExport('table', JSON.stringify(table));\n    callback(table);\n",
          "name": "function"
        },
        {
          "type": "PLA-1366",
          "value": true,
          "name": "provide_composite_access"
        },
        {
          "type": "PLA-1366",
          "value": [
            {
              "version": "3.7.0",
              "name": "js-yaml"
            }
          ],
          "name": "packages"
        }
      ],
      "executionTime": 6.106556164,
      "executionNumber": 8,
      "engineStatus": "OK",
      "dataType": "DEPLOY_RESOURCE",
      "_id": "58819719b718f26bebe51d37"
    }
  ],
  "numberOfResources": 13,
  "planRefreshIntervalInHours": 24,
  "lastExecutionTime": "2017-01-20T04:59:51.000Z",
  "engineState": "COMPLETED",
  "isEnabled": false
}